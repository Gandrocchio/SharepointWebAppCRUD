{"version":3,"sources":["webparts/helloWorld/HelloWorldWebPart.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8DAAqD;AAErD,8DAIoC;AAEpC,gEAAqD;AAErD,yDAAyD;AACzD,8BAAkD;AAClD,8BAA4B;AAC5B,kCAAgC;AAChC,iFAAqD;AACrD,kDAAoD;AAepD;IAA4C,kCAA8C;IAA1F;;IA6KA,CAAC;IA1Kc,+BAAM,GAAnB;;;;gBACE,EAAE,CAAC,GAAG,CAAC,WAAW,CAAC,OAAO,EAAE,kBAAkB,EAAE;;;;;gCAEhD,IAAI,CAAC,UAAU,CAAC,SAAS,GAAG,0BACX,uCAAM,CAAC,UAAU,kCACf,uCAAM,CAAC,SAAS,oCACd,uCAAM,CAAC,GAAG,sCACR,uCAAM,CAAC,MAAM,yCACV,uCAAM,CAAC,KAAK,mEACf,uCAAM,CAAC,QAAQ,2FACf,uCAAM,CAAC,WAAW,WAAM,yBAAM,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,oEAChC,uCAAM,CAAC,MAAM,2CACnC,uCAAM,CAAC,KAAK,mrBAgBrC,CAAC;gCACJ,IAAI,CAAC,iBAAiB,EAAE,CAAC;gCACzB,OAAO,CAAC,GAAG,CAAC,4BAA4B,CAAC,CAAC;gCAGtC,MAAM,GAAG,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,yBAAyB,CAAC,eAAe,EAAE,gDAAgD,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;gCACtI,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;gCACxC,qBAAM,IAAI,CAAC,eAAe,EAAE,EAAA;;gCAA5B,SAA4B,CAAC;gCAC7B,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gCACtC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;;;;qBACnC,CAAC,CAAC;;;;KACJ;IAED,sBAAc,uCAAW;aAAzB;YACE,OAAO,yBAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC;;;OAAA;IAES,qDAA4B,GAAtC;QACE,OAAO;YACL,KAAK,EAAE;gBACL;oBACE,MAAM,EAAE;wBACN,WAAW,EAAE,OAAO,CAAC,uBAAuB;qBAC7C;oBACD,MAAM,EAAE;wBACN;4BACE,SAAS,EAAE,OAAO,CAAC,cAAc;4BACjC,WAAW,EAAE;gCACX,uCAAqB,CAAC,aAAa,EAAE;oCACnC,KAAK,EAAE,OAAO,CAAC,qBAAqB;iCACrC,CAAC;6BACH;yBACF;qBACF;iBACF;aACF;SACF,CAAC;IACJ,CAAC;IAEO,0CAAiB,GAAzB;QAAA,iBAIC;QAHC,QAAQ,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,SAAS,EAAE,EAAhB,CAAgB,CAAC,CAAC;QACvF,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,aAAa,EAAE,EAApB,CAAoB,CAAC,CAAC;QAC9F,QAAQ,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,cAAM,OAAA,KAAI,CAAC,aAAa,EAAE,EAApB,CAAoB,CAAC,CAAC;IAChG,CAAC;IAED,OAAO;IAEP,SAAS;IACC,kCAAS,GAAnB;QACE,OAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC;YACzC,IAAI,EAAE,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;YAC9C,OAAO,EAAE,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC;YACpD,KAAK,EAAE,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC;SACjD,CAAC,CAAC,IAAI,CAAC,UAAC,MAAqB;YAC5B,KAAK,CAAC,sBAAsB,CAAC,CAAC;YAC9B,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,MAAa,IAAK,OAAA,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAnB,CAAmB,CAAC,CAAC;IACnD,CAAC;IAED,MAAM;IACE,mCAAU,GAAlB;QAAA,iBAqBC;QAnBC,OAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,UAAC,QAAmB;YACvE,IAAI,UAAU,GAAW,OAAO,CAAC;YACjC,uBAAuB;YACvB,sEAAsE;YACtE,IAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EACtB;gBACE,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAa;oBAC7B,UAAU,IAAI,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;oBACrD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;gBAC5C,CAAC,CAAC,CAAC;aACJ;iBACI;gBACD,UAAU,IAAI,2BAA2B,CAAC;aAC7C;YAED,UAAU,IAAI,QAAQ,CAAC;YACvB,IAAM,aAAa,GAAY,KAAI,CAAC,UAAU,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;YAC7E,aAAa,CAAC,SAAS,GAAG,UAAU,CAAC;QACvC,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,KAAK,IAAK,OAAA,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAlB,CAAkB,CAAC,CAAC;IAC1C,CAAC;IAED,gBAAgB;IACF,wCAAe,GAA7B;;;;;4BAE4B,qBAAM,OAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,EAAA;;wBAA3E,QAAQ,GAAc,SAAqD;wBAC3E,UAAU,GAAW,OAAO,CAAC;wBAE/B,IAAG,QAAQ,CAAC,MAAM,GAAG,CAAC,EACtB;4BACE,QAAQ,CAAC,OAAO,CAAC,UAAC,IAAa;gCAC7B,UAAU,IAAI,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;gCACrD,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC;4BAC5C,CAAC,CAAC,CAAC;yBACJ;6BACI;4BACD,UAAU,IAAI,2BAA2B,CAAC;yBAC7C;wBAED,UAAU,IAAI,QAAQ,CAAC;wBACjB,aAAa,GAAY,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;wBAC7E,aAAa,CAAC,SAAS,GAAG,UAAU,CAAC;;;;;KAExC;IAED,SAAS;IACD,sCAAa,GAArB;QACI,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC,iCAAiC;QAC7C,IAAI,IAAI,GAAG,OAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,UAAA,CAAC,IAAK,CAAC,CAAC,CAAC;IACjD,CAAC;IAED,SAAS;IACD,sCAAa,GAArB;QACI,IAAI,EAAE,GAAG,CAAC,CAAC;QACX,IAAI,IAAI,GAAG,OAAE,CAAC,GAAG,CAAC,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QAE5C,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;YAC3B,IAAI,EAAE,QAAQ,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC;YAC9C,OAAO,EAAE,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC;YACpD,KAAK,EAAE,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC;SACjD,CAAC,CAAC,IAAI,CAAC,UAAA,CAAC;YACP,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACjB,CAAC,CAAC,CAAC;IACP,CAAC;IAED,sBAAsB;IACR,6BAAI,GAAlB;;;;;wBACE,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;wBAC7B,qBAAM,OAAO,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,KAAK,CAAC,EAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,EAAA;;wBAAzE,SAAyE,CAAC;wBAC1E,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;;;;;KAC5B;IAEa,mCAAU,GAAxB,UAAyB,CAAU,EAAE,OAAe;;;;;;wBAClD,OAAO,CAAC,GAAG,CAAC,mBAAmB,CAAC,CAAC;wBAC1B,qBAAM,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC;;oCACtC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;oCACf,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;;;iCAChC,EAAE,OAAO,CAAC,CAAC,EAAA;4BAHZ,sBAAO,SAGK,EAAC;;;;KACd;IAEH,qBAAC;AAAD,CA7KA,AA6KC,CA7K2C,uCAAqB,GA6KhE","file":"webparts/helloWorld/HelloWorldWebPart.js","sourcesContent":["import { Version } from \"@microsoft/sp-core-library\";\r\n\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField\r\n} from \"@microsoft/sp-webpart-base\";\r\n\r\nimport { escape } from \"@microsoft/sp-lodash-subset\";\r\n\r\n//import * as pnp from '../../../node_modules/sp-pnp-js';\r\nimport { sp, ItemAddResult, Item } from \"@pnp/sp\";\r\nimport \"@pnp/polyfill-ie11\"; \r\nimport \"es6-object-assign/auto\";\r\nimport styles from './HelloWorldWebPart.module.scss';\r\nimport * as strings from 'HelloWorldWebPartStrings';\r\nimport { PopupWindowPosition } from '@microsoft/sp-webpart-base/lib/propertyPane/propertyPaneFields/propertyPaneLink/IPropertyPaneLink';\r\n\r\n\r\nexport interface IHelloWorldWebPartProps {\r\n  description: string;\r\n}\r\n\r\nexport interface ISPList {\r\n  ID?: string;\r\n  Nome?: string;\r\n  Cognome?: string;\r\n  Title?: string;\r\n}\r\n\r\nexport default class CRUDHelloWorld extends BaseClientSideWebPart<IHelloWorldWebPartProps> {\r\n\r\n\r\n  public async render(): Promise<void> {\r\n    SP.SOD.executeFunc('sp.js', 'SP.ClientContext', async () => { \r\n      \r\n    this.domElement.innerHTML = `\r\n      <div class=\"${ styles.helloWorld }\">\r\n        <div class=\"${ styles.container }\">\r\n          <div class=\"${ styles.row }\">\r\n            <div class=\"${ styles.column }\">\r\n              <span class=\"${ styles.title }\">Welcome to SharePoint!</span>\r\n              <p class=\"${ styles.subTitle }\">Customize SharePoint experiences using Web Parts.</p>\r\n              <p class=\"${ styles.description }\">${escape(this.properties.description)}</p>\r\n              <a href=\"https://aka.ms/spfx\" class=\"${ styles.button }\">\r\n                <span class=\"${ styles.label }\">Learn more</span>\r\n              </a>\r\n            </div>\r\n            <div>\r\n                  <input id=\"Title\" placeholder=\"Title\" />          \r\n                  <input id=\"Nome\" placeholder=\"Nome\" />\r\n                  <input id=\"Cognome\" placeholder=\"Cognome\" />\r\n                  <button id=\"AddSPItem\" type=\"submit\">Aggiungi Elemento</button>\r\n                  <button id=\"UpdateSPItem\" type=\"submit\">Aggiorna Elemento</button>\r\n                  <button id=\"DeleteSPItem\" type=\"submit\">Cancella Elemento</button>\r\n            </div>\r\n            <br>\r\n            <div id =\"DivGetItems\" />\r\n          </div>\r\n        </div>\r\n       </div>\r\n      `;\r\n    this.AddEventListeners();\r\n    console.log(\"Inizio chiamata getSPItems\");\r\n    //this.getSPItems();\r\n\r\n    let dialog = SP.UI.ModalDialog.showWaitScreenWithNoClose('Processing...', 'questa modal scomparirà tra qualche secondo...', 130, 350);\r\n    console.log(\"Inizio render --> main()\");\r\n    await this.getSPItemsAsync();\r\n    console.log(\"Fine render --> main()\");\r\n    dialog.close(SP.UI.DialogResult.OK); \r\n    });\r\n  }\r\n\r\n  protected get dataVersion(): Version {\r\n    return Version.parse(\"1.0\");\r\n  }\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('description', {\r\n                  label: strings.DescriptionFieldLabel\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n\r\n  private AddEventListeners() : void  {\r\n    document.getElementById(\"AddSPItem\").addEventListener(\"click\", () => this.AddSPItem());\r\n    document.getElementById(\"DeleteSPItem\").addEventListener(\"click\", () => this.deleteSPItems());\r\n    document.getElementById(\"UpdateSPItem\").addEventListener(\"click\", () => this.UpdateSPItems());\r\n  }\r\n\r\n  // REST\r\n\r\n  // Insert\r\n  protected AddSPItem() : void {\r\n    sp.web.lists.getByTitle(\"prova\").items.add({\r\n      Nome: document.getElementById(\"Nome\")[\"value\"],\r\n      Cognome: document.getElementById(\"Cognome\")[\"value\"],\r\n      Title: document.getElementById(\"Title\")[\"value\"]\r\n    }).then((result: ItemAddResult) => {\r\n      alert(\"Operazone Completata\");\r\n      console.log(result.item);\r\n    }).catch((errors: any[]) => console.log(errors));\r\n  }\r\n\r\n  // GET\r\n  private getSPItems() : void {\r\n    \r\n    sp.web.lists.getByTitle(\"prova\").items.getAll().then((AllItems: ISPList[]) => {\r\n      let stringHtml: string = \"<div>\";\r\n      //let array: ISPList[];\r\n      //array = [{ Nome: \"Gabriele\", Cognome: \"Ascione\", Title: \"Prova\" },];\r\n      if(AllItems.length > 0) \r\n      {\r\n        AllItems.forEach((item: ISPList) => { \r\n          stringHtml += item.ID + \" \" + item.Cognome + \"</br>\";\r\n          console.log(item.ID + \" \" + item.Cognome);\r\n        });\r\n      }\r\n      else {\r\n          stringHtml += \"Non ci sono elementi</br>\";\r\n      }\r\n      \r\n      stringHtml += \"</div>\";\r\n      const listContainer: Element = this.domElement.querySelector('#DivGetItems'); \r\n      listContainer.innerHTML = stringHtml;\r\n    }).catch((error) => console.log(error));\r\n  }\r\n\r\n  // GET Asincrona\r\n  private async getSPItemsAsync() : Promise<void> {\r\n    \r\n    let AllItems: ISPList[] = await sp.web.lists.getByTitle(\"prova\").items.getAll(); \r\n    let stringHtml: string = \"<div>\";\r\n      \r\n      if(AllItems.length > 0) \r\n      {\r\n        AllItems.forEach((item: ISPList) => { \r\n          stringHtml += item.ID + \" \" + item.Cognome + \"</br>\";\r\n          console.log(item.ID + \" \" + item.Cognome);\r\n        });\r\n      }\r\n      else {\r\n          stringHtml += \"Non ci sono elementi</br>\";\r\n      }\r\n      \r\n      stringHtml += \"</div>\";\r\n      const listContainer: Element = this.domElement.querySelector('#DivGetItems'); \r\n      listContainer.innerHTML = stringHtml;\r\n    //});.catch((error) => console.log(error));\r\n  }\r\n\r\n  // Delete\r\n  private deleteSPItems() : void {\r\n      var id = 1; // Ricerca tramite nome e cognome\r\n      let list = sp.web.lists.getByTitle(\"prova\");\r\n      list.items.getById(1).delete().then(_ => {});\r\n  }\r\n\r\n  // Update\r\n  private UpdateSPItems() : void {\r\n      var id = 1;\r\n      let list = sp.web.lists.getByTitle(\"prova\");\r\n\r\n      list.items.getById(1).update({\r\n        Nome: document.getElementById(\"Nome\")[\"value\"],\r\n        Cognome: document.getElementById(\"Cognome\")[\"value\"],\r\n        Title: document.getElementById(\"Title\")[\"value\"]\r\n      }).then(i => {\r\n        console.log(i);\r\n      });\r\n  }\r\n\r\n  //Async Call e Promise\r\n  private async main() : Promise<void> {\r\n    console.log(\"Inizio main()\");\r\n    await Promise.all([this.logConsole(\"1\", 10000),this.logConsole(\"2\", 10)]);      \r\n    console.log(\"Fine main()\");    \r\n  }\r\n\r\n  private async logConsole(s : string, timeout: number) {\r\n    console.log(\"Inizio LogConsole\");\r\n    return await Promise.resolve(setTimeout(async () => { \r\n      console.log(s);     \r\n      console.log(\"Fine LogConsole\");    \r\n    }, timeout));\r\n  }\r\n\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}