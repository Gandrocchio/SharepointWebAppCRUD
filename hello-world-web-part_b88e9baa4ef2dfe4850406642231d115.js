define("86d5eb9f-b5a2-4223-9cd6-088377d6ea68_0.0.1",["@microsoft/sp-core-library","@microsoft/sp-lodash-subset","@microsoft/sp-webpart-base","HelloWorldWebPartStrings"],function(e,t,n,r){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=18)}([function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){function r(e,t){function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function i(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!h(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function a(){var e=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function u(e){return"function"==typeof e}function c(e){return void 0!==e&&null!==e}function l(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function p(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!c(t))return e;var o=n?function(e,t){return!(t in e)}:function(){return!0},i=function(t){return o(e,t)&&r(t)};return Object.getOwnPropertyNames(t).filter(i).reduce(function(e,n){return e[n]=t[n],e},e)}function f(e){return/^https?:\/\/|^\/\//i.test(e)}function h(e){return void 0===e||null===e||e.length<1}function d(e){return JSON.stringify(e)}function y(e,t){return Object.hasOwnProperty.call(e,t)}function g(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}function m(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}}function v(e,t){if(c(t)){var n=p(e.headers||{},t.headers);e=p(e,t),e.headers=n}}function b(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.hostname}function _(e){return void 0!==e&&null!==e?new Map(E(e)):new Map}function S(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)t[r].forEach(function(t,n){e.set(n,t)});return e}var T=n(15);n.n(T);n.d(t,"e",function(){return A}),n.d(t,"g",function(){return m}),n.d(t,"j",function(){return v}),n.d(t,"f",function(){return C}),n.d(t,"q",function(){return k}),n.d(t,"h",function(){return o}),n.d(t,"m",function(){return i}),n.d(t,"c",function(){return s}),n.d(t,"k",function(){return a}),n.d(t,"r",function(){return u}),n.d(t,"n",function(){return c}),n.d(t,"p",function(){return l}),n.d(t,"d",function(){return p}),n.d(t,"i",function(){return f}),n.d(t,"a",function(){return h}),n.d(t,"l",function(){return d}),n.d(t,"b",function(){return y}),n.d(t,"o",function(){return g});/**
 * @license
 * v1.3.3
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},P=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},C=function(){function e(){}return e.prototype.fetch=function(e,t){return P.fetch(e,t)},e}(),O=function(e){function t(t){var n=e.call(this)||this;return n._token=t,n}return r(t,e),Object.defineProperty(t.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return m(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},t}(C),I=(function(e){function t(t,n,r){var o=e.call(this,null)||this;return o.clientId=t,o.tenant=n,o.redirectUri=r,o._displayCallback=null,o._loginPromise=null,o}r(t,e),t.fromSPFxContext=function(e){return new I(e)},t.prototype.fetch=function(t,n){var r=this;if(!f(t))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(b(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){var n=this;return new Promise(function(r,o){n.ensureAuthContext().then(function(e){return n.login()}).then(function(n){t._authContext.acquireToken(e,function(e,t){if(e)return o(Error(e));r(t)})}).catch(o)})},t.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(r){null===t._authContext&&(t._authContext=n.i(T.inject)({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),r()})},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(n,r){if(t._authContext.getCachedUser())return n();e._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return r(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var s=window.setInterval(function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(s);try{-1!==i.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(s),t._authContext.handleWindowCallback(i.location.hash),i.close(),n())}catch(e){r(e)}},30)},e.ensureAuthContext().then(function(n){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null})}),this._loginPromise)},t._authContext=null}(O),function(e){function t(t){var n=e.call(this,null)||this;return n.context=t,n}return r(t,e),t.prototype.fetch=function(t,n){var r=this;return this.getToken(b(t)).then(function(o){return r.token=o,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){return this.context.aadTokenProviderFactory.getTokenProvider().then(function(t){return t.getToken(e)})},t}(O)),E=u(Object.entries)?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})},N=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"],x=function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(N[0],"session"),this._v.set(N[1],60),this._v.set(N[2],!1),this._v.set(N[3],!1),this._v.set(N[4],750),this._v.set(N[5],null)}return e.prototype.extend=function(e){this._v=S(this._v,_(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(N[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(N[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(N[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(N[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(N[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(N[5])},enumerable:!0,configurable:!0}),e}(),R=new x,A=R,U=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),A.enableCacheExpiration&&this.cacheExpirationHandler()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!c(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;if(!this.enabled)return t();var o=this.get(e);return null===o?t().then(function(t){return r.put(e,t,n),t}):Promise.resolve(o)},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var o=e.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(o))&&e.get(o)}t()}catch(e){n(e)}})},e.prototype.test=function(){var e="t";try{return this.store.setItem(e,e),this.store.removeItem(e),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=A.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=i(new Date,"second",n)}return d({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.deleteExpired().then(function(t){setTimeout(o(e,e.cacheExpirationHandler),A.cacheExpirationIntervalMilliseconds)}).catch(function(e){console.error(e)})},e}(),j=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),k=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=this.getStore("local")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=this.getStore("session")),this._session},enumerable:!0,configurable:!0}),e.prototype.getStore=function(e){return new U("local"===e?"undefined"==typeof localStorage?new j:localStorage:"undefined"==typeof sessionStorage?new j:sessionStorage)},e}()}).call(t,n(0))},function(e,t,n){"use strict";n.d(t,"a",function(){return o});/**
 * @license
 * v1.3.3
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
var r,o=function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new i),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=1),e.instance.log({level:n,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}(),i=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(r||(r={}));(function(){function e(){}e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];if(t.push("Message: "+e.message),void 0!==e.data)try{t.push(" Data: "+JSON.stringify(e.data))}catch(e){t.push(" Data: Error in stringify of supplied data "+e)}return t.join("")}})(),function(){function e(e){this.method=e}e.prototype.log=function(e){this.method(e)}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(11);var r={helloWorld:"helloWorld_e50749f6",container:"container_e50749f6",row:"row_e50749f6",column:"column_e50749f6","ms-Grid":"ms-Grid_e50749f6",title:"title_e50749f6",subTitle:"subTitle_e50749f6",description:"description_e50749f6",button:"button_e50749f6",label:"label_e50749f6"};t.default=r},function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=131)}([function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(35)("wks"),o=n(24),i=n(0).Symbol,s="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=s&&i[e]||(s?i:o)("Symbol."+e))}).store=r},function(e,t,n){"use strict";var r=n(7);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,n){"use strict";e.exports=n(108)()?Symbol:n(109)},function(e,t,n){var r=n(12);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";var r=n(32),o=n(54),i=n(104),s=n(55);(e.exports=function(e,t){var n,i,a,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(n=a=!0,i=!1):(n=s.call(e,"c"),i=s.call(e,"e"),a=s.call(e,"w")),c={value:t,configurable:n,enumerable:i,writable:a},u?r(o(u),c):c}).gs=function(e,t,n){var a,u,c,l;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(a=!0,u=!1):(a=s.call(e,"c"),u=s.call(e,"e")),l={get:t,set:n,configurable:a,enumerable:u},c?r(o(c),l):l}},function(e,t,n){"use strict";var r=n(50)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){var r=n(14);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n=e.exports={version:"2.6.2"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(11),o=n(26);e.exports=n(13)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(5),o=n(58),i=n(59),s=Object.defineProperty;t.f=n(13)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(36)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(0),o=n(9),i=n(10),s=n(27),a=n(8),u=function(e,t,n){var c,l,p,f,h=e&u.F,d=e&u.G,y=e&u.S,g=e&u.P,m=e&u.B,v=d?r:y?r[t]||(r[t]={}):(r[t]||{}).prototype,b=d?o:o[t]||(o[t]={}),_=b.prototype||(b.prototype={});for(c in d&&(n=t),n)p=((l=!h&&v&&void 0!==v[c])?v:n)[c],f=m&&l?a(p,r):g&&"function"==typeof p?a(Function.call,p):p,v&&s(v,c,p,e&u.U),b[c]!=p&&i(b,c,f),g&&_[c]!=p&&(_[c]=p)};r.core=o,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){var r=n(39),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){"use strict";e.exports=n(52)()?Object.setPrototypeOf:n(53)},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call(function(){return arguments}());e.exports=function(e){return r.call(e)===o}},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call("");e.exports=function(e){return"string"==typeof e||e&&"object"==typeof e&&(e instanceof String||r.call(e)===o)||!1}},function(e,t){e.exports=!1},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(12),o=n(0).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(0),o=n(10),i=n(17),s=n(24)("src"),a=Function.toString,u=(""+a).split("toString");n(9).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var c="function"==typeof n;c&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(i(n,s)||o(n,s,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,n){var r=n(11).f,o=n(17),i=n(1)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(72),o=n(46);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(35)("keys"),o=n(24);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(46);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";e.exports=n(99)()?Object.assign:n(100)},function(e,t,n){"use strict";var r,o=n(49),i=n(32),s=n(3),a=n(2),u=n(6),c=n(116),l=n(4),p=Object.defineProperty,f=Object.defineProperties;e.exports=r=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");f(this,{__list__:u("w",a(e)),__context__:u("w",t),__nextIndex__:u("w",0)}),t&&(s(t.on),t.on("_add",this._onAdd),t.on("_delete",this._onDelete),t.on("_clear",this._onClear))},delete r.prototype.constructor,f(r.prototype,i({_next:u(function(){var e;if(this.__list__)return this.__redo__&&void 0!==(e=this.__redo__.shift())?e:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:u(function(){return this._createResult(this._next())}),_createResult:u(function(e){return void 0===e?{done:!0,value:void 0}:{done:!1,value:this._resolve(e)}}),_resolve:u(function(e){return this.__list__[e]}),_unBind:u(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:u(function(){return"[object "+(this[l.toStringTag]||"Object")+"]"})},c({_onAdd:u(function(e){e>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(t,n){t>=e&&(this.__redo__[n]=++t)},this),this.__redo__.push(e)):p(this,"__redo__",u("c",[e])))}),_onDelete:u(function(e){var t;e>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(t=this.__redo__.indexOf(e))&&this.__redo__.splice(t,1),this.__redo__.forEach(function(t,n){t>e&&(this.__redo__[n]=--t)},this)))}),_onClear:u(function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0})}))),p(r.prototype,l.iterator,u(function(){return this}))},function(e,t,n){var r=n(15),o=n(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){var r=n(9),o=n(0),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(23)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(5);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(18),o=n(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(34),o=n(1)("iterator"),i=n(18);e.exports=n(9).getIteratorMethod=function(e){if(void 0!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r,o,i,s=n(8),a=n(63),u=n(42),c=n(25),l=n(0),p=l.process,f=l.setImmediate,h=l.clearImmediate,d=l.MessageChannel,y=l.Dispatch,g=0,m={},v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){v.call(e.data)};f&&h||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){a("function"==typeof e?e:Function(e),t)},r(g),g},h=function(e){delete m[e]},"process"==n(15)(p)?r=function(e){p.nextTick(s(v,e,1))}:y&&y.now?r=function(e){y.now(s(v,e,1))}:d?(i=(o=new d).port2,o.port1.onmessage=b,r=s(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(s(v,e,1),0)}),e.exports={set:f,clear:h}},function(e,t,n){var r=n(0).document;e.exports=r&&r.documentElement},function(e,t,n){"use strict";var r=n(14);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(1)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],s=i[r]();s.next=function(){return{done:n=!0}},i[r]=function(){return s},e(i)}catch(e){}return n}},function(e,t,n){var r=n(1)("unscopables"),o=Array.prototype;void 0==o[r]&&n(10)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(39),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(2);e.exports=function(){return r(this).length=0,this}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(93),o=Math.max;e.exports=function(e){return o(0,r(e))}},function(e,t,n){"use strict";var r=Object.create,o=Object.getPrototypeOf,i={};e.exports=function(){var e=Object.setPrototypeOf,t=arguments[0]||r;return"function"==typeof e&&o(e(t(null),i))===i}},function(e,t,n){"use strict";var r,o=n(97),i=n(2),s=Object.prototype.isPrototypeOf,a=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(e,t){if(i(e),null===t||o(t))return e;throw new TypeError("Prototype must be null or an object")},e.exports=function(e){var t,n;return e?(2===e.level?e.set?(n=e.set,t=function(e,t){return n.call(r(e,t),t),e}):t=function(e,t){return r(e,t).__proto__=t,e}:t=function e(t,n){var o;return r(t,n),(o=s.call(e.nullPolyfill,t))&&delete e.nullPolyfill.__proto__,null===n&&(n=e.nullPolyfill),t.__proto__=n,o&&a(e.nullPolyfill,"__proto__",u),t},Object.defineProperty(t,"level",{configurable:!1,enumerable:!1,writable:!1,value:e.level})):null}(function(){var e,t=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{(e=r.set).call(t,n)}catch(e){}if(Object.getPrototypeOf(t)===n)return{set:e,level:2}}return t.__proto__=n,Object.getPrototypeOf(t)===n?{level:2}:((t={}).__proto__=n,Object.getPrototypeOf(t)===n&&{level:1})}()),n(98)},function(e,t,n){"use strict";var r=n(7),o=Array.prototype.forEach,i=Object.create;e.exports=function(e){var t=i(null);return o.call(arguments,function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},function(e,t,n){"use strict";e.exports=n(105)()?String.prototype.contains:n(106)},function(e,t,n){"use strict";var r=n(112);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not iterable");return e}},function(e,t,n){"use strict";var r,o,i,s,a=n(23),u=n(0),c=n(8),l=n(34),p=n(16),f=n(12),h=n(14),d=n(60),y=n(61),g=n(62),m=n(41).set,v=n(64)(),b=n(43),_=n(65),S=n(66),T=n(67),w=u.TypeError,P=u.process,C=P&&P.versions,O=C&&C.v8||"",I=u.Promise,E="process"==l(P),N=function(){},x=o=b.f,R=!!function(){try{var e=I.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(N,N)};return(E||"function"==typeof PromiseRejectionEvent)&&e.then(N)instanceof t&&0!==O.indexOf("6.6")&&-1===S.indexOf("Chrome/66")}catch(e){}}(),A=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},U=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,o=1==e._s,i=0,s=function(t){var n,i,s,a=o?t.ok:t.fail,u=t.resolve,c=t.reject,l=t.domain;try{a?(o||(2==e._h&&D(e),e._h=1),!0===a?n=r:(l&&l.enter(),n=a(r),l&&(l.exit(),s=!0)),n===t.promise?c(w("Promise-chain cycle")):(i=A(n))?i.call(n,u,c):u(n)):c(r)}catch(e){l&&!s&&l.exit(),c(e)}};n.length>i;)s(n[i++]);e._c=[],e._n=!1,t&&!e._h&&j(e)})}},j=function(e){m.call(u,function(){var t,n,r,o=e._v,i=k(e);if(i&&(t=_(function(){E?P.emit("unhandledRejection",o,e):(n=u.onunhandledrejection)?n({promise:e,reason:o}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",o)}),e._h=E||k(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},k=function(e){return 1!==e._h&&0===(e._a||e._c).length},D=function(e){m.call(u,function(){var t;E?P.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},L=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),U(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw w("Promise can't be resolved itself");(t=A(e))?v(function(){var r={_w:n,_d:!1};try{t.call(e,c(F,r,1),c(L,r,1))}catch(e){L.call(r,e)}}):(n._v=e,n._s=1,U(n,!1))}catch(e){L.call({_w:n,_d:!1},e)}}};R||(I=function(e){d(this,I,"Promise","_h"),h(e),r.call(this);try{e(c(F,this,1),c(L,this,1))}catch(e){L.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(68)(I.prototype,{then:function(e,t){var n=x(g(this,I));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=E?P.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&U(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=c(F,e,1),this.reject=c(L,e,1)},b.f=x=function(e){return e===I||e===s?new i(e):o(e)}),p(p.G+p.W+p.F*!R,{Promise:I}),n(28)(I,"Promise"),n(69)("Promise"),s=n(9).Promise,p(p.S+p.F*!R,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),p(p.S+p.F*(a||!R),"Promise",{resolve:function(e){return T(a&&this===s?I:this,e)}}),p(p.S+p.F*!(R&&n(44)(function(e){I.all(e).catch(N)})),"Promise",{all:function(e){var t=this,n=x(t),r=n.resolve,o=n.reject,i=_(function(){var n=[],i=0,s=1;y(e,!1,function(e){var a=i++,u=!1;n.push(void 0),s++,t.resolve(e).then(function(e){u||(u=!0,n[a]=e,--s||r(n))},o)}),--s||r(n)});return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=x(t),r=n.reject,o=_(function(){y(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return o.e&&r(o.v),n.promise}})},function(e,t,n){e.exports=!n(13)&&!n(36)(function(){return 7!=Object.defineProperty(n(25)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(12);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(8),o=n(37),i=n(38),s=n(5),a=n(19),u=n(40),c={},l={};(t=e.exports=function(e,t,n,p,f){var h,d,y,g,m=f?function(){return e}:u(e),v=r(n,p,t?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(i(m)){for(h=a(e.length);h>b;b++)if((g=t?v(s(d=e[b])[0],d[1]):v(e[b]))===c||g===l)return g}else for(y=m.call(e);!(d=y.next()).done;)if((g=o(y,v,d.value,t))===c||g===l)return g}).BREAK=c,t.RETURN=l},function(e,t,n){var r=n(5),o=n(14),i=n(1)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[i])?t:o(n)}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(0),o=n(41).set,i=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(15)(s);e.exports=function(){var e,t,n,c=function(){var r,o;for(u&&(r=s.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(!i||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var l=a.resolve(void 0);n=function(){l.then(c)}}else n=function(){o.call(r,c)};else{var p=!0,f=document.createTextNode("");new i(c).observe(f,{characterData:!0}),n=function(){f.data=p=!p}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(0).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(5),o=n(12),i=n(43);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(27);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){"use strict";var r=n(0),o=n(11),i=n(13),s=n(1)("species");e.exports=function(e){var t=r[e];i&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(45),o=n(71),i=n(18),s=n(29);e.exports=n(73)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(15);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(23),o=n(16),i=n(27),s=n(10),a=n(18),u=n(74),c=n(28),l=n(80),p=n(1)("iterator"),f=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,d,y,g,m){u(n,t,d);var v,b,_,S=function(e){if(!f&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",w="values"==y,P=!1,C=e.prototype,O=C[p]||C["@@iterator"]||y&&C[y],I=O||S(y),E=y?w?S("entries"):I:void 0,N="Array"==t&&C.entries||O;if(N&&(_=l(N.call(new e)))!==Object.prototype&&_.next&&(c(_,T,!0),r||"function"==typeof _[p]||s(_,p,h)),w&&O&&"values"!==O.name&&(P=!0,I=function(){return O.call(this)}),r&&!m||!f&&!P&&C[p]||s(C,p,I),a[t]=I,a[T]=h,y)if(v={values:w?I:S("values"),keys:g?I:S("keys"),entries:E},m)for(b in v)b in C||i(C,b,v[b]);else o(o.P+o.F*(f||P),t,v);return v}},function(e,t,n){"use strict";var r=n(75),o=n(26),i=n(28),s={};n(10)(s,n(1)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(s,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(5),o=n(76),i=n(48),s=n(30)("IE_PROTO"),a=function(){},u=function(){var e,t=n(25)("iframe"),r=i.length;for(t.style.display="none",n(42).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=u(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(11),o=n(5),i=n(77);e.exports=n(13)?Object.defineProperties:function(e,t){o(e);for(var n,s=i(t),a=s.length,u=0;a>u;)r.f(e,n=s[u++],t[n]);return e}},function(e,t,n){var r=n(78),o=n(48);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t,n){var r=n(17),o=n(29),i=n(79)(!1),s=n(30)("IE_PROTO");e.exports=function(e,t){var n,a=o(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~i(c,n)||c.push(n));return c}},function(e,t,n){var r=n(29),o=n(19),i=n(47);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=o(u.length),l=i(s,c);if(e&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},function(e,t,n){var r=n(17),o=n(31),i=n(30)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){"use strict";var r=n(8),o=n(16),i=n(31),s=n(37),a=n(38),u=n(19),c=n(82),l=n(40);o(o.S+o.F*!n(44)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,o,p,f=i(e),h="function"==typeof this?this:Array,d=arguments.length,y=d>1?arguments[1]:void 0,g=void 0!==y,m=0,v=l(f);if(g&&(y=r(y,d>2?arguments[2]:void 0,2)),void 0==v||h==Array&&a(v))for(n=new h(t=u(f.length));t>m;m++)c(n,m,g?y(f[m],m):f[m]);else for(p=v.call(f),n=new h;!(o=p.next()).done;m++)c(n,m,g?s(p,y,[o.value,m],!0):o.value);return n.length=m,n}})},function(e,t,n){"use strict";var r=n(11),o=n(26);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){var r=n(16);r(r.P,"Array",{fill:n(84)}),n(45)("fill")},function(e,t,n){"use strict";var r=n(31),o=n(47),i=n(19);e.exports=function(e){for(var t=r(this),n=i(t.length),s=arguments.length,a=o(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,c=void 0===u?n:o(u,n);c>a;)t[a++]=e;return t}},function(e,t,n){"use strict";n(86)()||Object.defineProperty(n(87),"Map",{value:n(88),configurable:!0,enumerable:!1,writable:!0})},function(e,t,n){"use strict";e.exports=function(){var e,t;if("function"!=typeof Map)return!1;try{e=new Map([["raz","one"],["dwa","two"],["trzy","three"]])}catch(e){return!1}return"[object Map]"===String(e)&&3===e.size&&"function"==typeof e.clear&&"function"==typeof e.delete&&"function"==typeof e.entries&&"function"==typeof e.forEach&&"function"==typeof e.get&&"function"==typeof e.has&&"function"==typeof e.keys&&"function"==typeof e.set&&"function"==typeof e.values&&!1===(t=e.entries().next()).done&&!!t.value&&"raz"===t.value[0]&&"one"===t.value[1]}},function(e,t){e.exports=function(){return this}()},function(e,t,n){"use strict";var r,o=n(49),i=n(89),s=n(20),a=n(3),u=n(2),c=n(6),l=n(107),p=n(4),f=n(56),h=n(113),d=n(126),y=n(129),g=Function.prototype.call,m=Object.defineProperties,v=Object.getPrototypeOf;e.exports=r=function(){var e,t,n,o=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return n=y&&s&&Map!==r?s(new Map,v(this)):this,null!=o&&f(o),m(n,{__mapKeysData__:c("c",e=[]),__mapValuesData__:c("c",t=[])}),o?(h(o,function(n){var r=u(n)[0];n=n[1],-1===i.call(e,r)&&(e.push(r),t.push(n))},n),n):n},y&&(s&&s(r,Map),r.prototype=Object.create(Map.prototype,{constructor:c(r)})),l(m(r.prototype,{clear:c(function(){this.__mapKeysData__.length&&(o.call(this.__mapKeysData__),o.call(this.__mapValuesData__),this.emit("_clear"))}),delete:c(function(e){var t=i.call(this.__mapKeysData__,e);return-1!==t&&(this.__mapKeysData__.splice(t,1),this.__mapValuesData__.splice(t,1),this.emit("_delete",t,e),!0)}),entries:c(function(){return new d(this,"key+value")}),forEach:c(function(e){var t,n,r=arguments[1];for(a(e),n=(t=this.entries())._next();void 0!==n;)g.call(e,r,this.__mapValuesData__[n],this.__mapKeysData__[n],this),n=t._next()}),get:c(function(e){var t=i.call(this.__mapKeysData__,e);if(-1!==t)return this.__mapValuesData__[t]}),has:c(function(e){return-1!==i.call(this.__mapKeysData__,e)}),keys:c(function(){return new d(this,"key")}),set:c(function(e,t){var n,r=i.call(this.__mapKeysData__,e);return-1===r&&(r=this.__mapKeysData__.push(e)-1,n=!0),this.__mapValuesData__[r]=t,n&&this.emit("_add",r,e),this}),size:c.gs(function(){return this.__mapKeysData__.length}),values:c(function(){return new d(this,"value")}),toString:c(function(){return"[object Map]"})})),Object.defineProperty(r.prototype,p.iterator,c(function(){return this.entries()})),Object.defineProperty(r.prototype,p.toStringTag,c("c","Map"))},function(e,t,n){"use strict";var r=n(90),o=n(51),i=n(2),s=Array.prototype.indexOf,a=Object.prototype.hasOwnProperty,u=Math.abs,c=Math.floor;e.exports=function(e){var t,n,l,p;if(!r(e))return s.apply(this,arguments);for(n=o(i(this).length),l=arguments[1],t=l=isNaN(l)?0:l>=0?c(l):o(this.length)-c(u(l));t<n;++t)if(a.call(this,t)&&(p=this[t],r(p)))return t;return-1}},function(e,t,n){"use strict";e.exports=n(91)()?Number.isNaN:n(92)},function(e,t,n){"use strict";e.exports=function(){var e=Number.isNaN;return"function"==typeof e&&!e({})&&e(NaN)&&!e(34)}},function(e,t,n){"use strict";e.exports=function(e){return e!=e}},function(e,t,n){"use strict";var r=n(94),o=Math.abs,i=Math.floor;e.exports=function(e){return isNaN(e)?0:0!==(e=Number(e))&&isFinite(e)?r(e)*i(o(e)):e}},function(e,t,n){"use strict";e.exports=n(95)()?Math.sign:n(96)},function(e,t,n){"use strict";e.exports=function(){var e=Math.sign;return"function"==typeof e&&1===e(10)&&-1===e(-20)}},function(e,t,n){"use strict";e.exports=function(e){return e=Number(e),isNaN(e)||0===e?e:e>0?1:-1}},function(e,t,n){"use strict";var r=n(7),o={function:!0,object:!0};e.exports=function(e){return r(e)&&o[typeof e]||!1}},function(e,t,n){"use strict";var r,o=Object.create;n(52)()||(r=n(53)),e.exports=function(){var e,t,n;return r?1!==r.level?o:(e={},t={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(e){t[e]="__proto__"!==e?n:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(e,t),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:e}),function(t,n){return o(null===t?e:t,n)}):o}()},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(101),o=n(2),i=Math.max;e.exports=function(e,t){var n,s,a,u=i(arguments.length,2);for(e=Object(o(e)),a=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},s=1;s<u;++s)t=arguments[s],r(t).forEach(a);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(102)()?Object.keys:n(103)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(7),o=Object.keys;e.exports=function(e){return o(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&!0===r.contains("dwa")&&!1===r.contains("foo")}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";var r,o,i,s,a,u,c,l=n(6),p=n(3),f=Function.prototype.apply,h=Function.prototype.call,d=Object.create,y=Object.defineProperty,g=Object.defineProperties,m=Object.prototype.hasOwnProperty,v={configurable:!0,enumerable:!1,writable:!0};a={on:r=function(e,t){var n;return p(t),m.call(this,"__ee__")?n=this.__ee__:(n=v.value=d(null),y(this,"__ee__",v),v.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:o=function(e,t){var n,o;return p(t),o=this,r.call(this,e,n=function(){i.call(o,e,n),f.call(t,this,arguments)}),n.__eeOnceListener__=t,this},off:i=function(e,t){var n,r,o,i;if(p(t),!m.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(i=0;o=r[i];++i)o!==t&&o.__eeOnceListener__!==t||(2===r.length?n[e]=r[i?0:1]:r.splice(i,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},emit:s=function(e){var t,n,r,o,i;if(m.call(this,"__ee__")&&(o=this.__ee__[e]))if("object"==typeof o){for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];for(o=o.slice(),t=0;r=o[t];++t)f.call(r,this,i)}else switch(arguments.length){case 1:h.call(o,this);break;case 2:h.call(o,this,arguments[1]);break;case 3:h.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];f.call(o,this,i)}}},u={on:l(r),once:l(o),off:l(i),emit:l(s)},c=g({},u),e.exports=t=function(e){return null==e?d(c):g(Object(e),u)},t.methods=a},function(e,t,n){"use strict";var r={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!r[typeof Symbol.iterator]&&!!r[typeof Symbol.toPrimitive]&&!!r[typeof Symbol.toStringTag]}},function(e,t,n){"use strict";var r,o,i,s,a=n(6),u=n(110),c=Object.create,l=Object.defineProperties,p=Object.defineProperty,f=Object.prototype,h=c(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),s=!0}catch(e){}}var d=function(){var e=c(null);return function(t){for(var n,r,o=0;e[t+(o||"")];)++o;return e[t+=o||""]=!0,p(f,n="@@"+t,a.gs(null,function(e){r||(r=!0,p(this,n,a(e)),r=!1)})),n}}();i=function(e){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return o(e)},e.exports=o=function e(t){var n;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return s?r(t):(n=c(i.prototype),t=void 0===t?"":String(t),l(n,{__description__:a("",t),__name__:a("",d(t))}))},l(o,{for:a(function(e){return h[e]?h[e]:h[e]=o(String(e))}),keyFor:a(function(e){var t;for(t in u(e),h)if(h[t]===e)return t}),hasInstance:a("",r&&r.hasInstance||o("hasInstance")),isConcatSpreadable:a("",r&&r.isConcatSpreadable||o("isConcatSpreadable")),iterator:a("",r&&r.iterator||o("iterator")),match:a("",r&&r.match||o("match")),replace:a("",r&&r.replace||o("replace")),search:a("",r&&r.search||o("search")),species:a("",r&&r.species||o("species")),split:a("",r&&r.split||o("split")),toPrimitive:a("",r&&r.toPrimitive||o("toPrimitive")),toStringTag:a("",r&&r.toStringTag||o("toStringTag")),unscopables:a("",r&&r.unscopables||o("unscopables"))}),l(i.prototype,{constructor:a(o),toString:a("",function(){return this.__name__})}),l(o.prototype,{toString:a(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:a(function(){return u(this)})}),p(o.prototype,o.toPrimitive,a("",function(){var e=u(this);return"symbol"==typeof e?e:e.toString()})),p(o.prototype,o.toStringTag,a("c","Symbol")),p(i.prototype,o.toStringTag,a("c",o.prototype[o.toStringTag])),p(i.prototype,o.toPrimitive,a("c",o.prototype[o.toPrimitive]))},function(e,t,n){"use strict";var r=n(111);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},function(e,t,n){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&"Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag])}},function(e,t,n){"use strict";var r=n(21),o=n(7),i=n(22),s=n(4).iterator,a=Array.isArray;e.exports=function(e){return!(!o(e)||!a(e)&&!i(e)&&!r(e)&&"function"!=typeof e[s])}},function(e,t,n){"use strict";var r=n(21),o=n(3),i=n(22),s=n(114),a=Array.isArray,u=Function.prototype.call,c=Array.prototype.some;e.exports=function(e,t){var n,l,p,f,h,d,y,g,m=arguments[2];if(a(e)||r(e)?n="array":i(e)?n="string":e=s(e),o(t),p=function(){f=!0},"array"!==n)if("string"!==n)for(l=e.next();!l.done;){if(u.call(t,m,l.value,p),f)return;l=e.next()}else for(d=e.length,h=0;h<d&&(y=e[h],h+1<d&&(g=y.charCodeAt(0))>=55296&&g<=56319&&(y+=e[++h]),u.call(t,m,y,p),!f);++h);else c.call(e,function(e){return u.call(t,m,e,p),f})}},function(e,t,n){"use strict";var r=n(21),o=n(22),i=n(115),s=n(125),a=n(56),u=n(4).iterator;e.exports=function(e){return"function"==typeof a(e)[u]?e[u]():r(e)?new i(e):o(e)?new s(e):new i(e)}},function(e,t,n){"use strict";var r,o=n(20),i=n(55),s=n(6),a=n(4),u=n(33),c=Object.defineProperty;r=e.exports=function(e,t){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");u.call(this,e),t=t?i.call(t,"key+value")?"key+value":i.call(t,"key")?"key":"value":"value",c(this,"__kind__",s("",t))},o&&o(r,u),delete r.prototype.constructor,r.prototype=Object.create(u.prototype,{_resolve:s(function(e){return"value"===this.__kind__?this.__list__[e]:"key+value"===this.__kind__?[e,this.__list__[e]]:e})}),c(r.prototype,a.toStringTag,s("c","Array Iterator"))},function(e,t,n){"use strict";var r,o=n(117),i=n(54),s=n(3),a=n(122),u=n(3),c=n(2),l=Function.prototype.bind,p=Object.defineProperty,f=Object.prototype.hasOwnProperty;r=function(e,t,n){var r,i=c(t)&&u(t.value);return delete(r=o(t)).writable,delete r.value,r.get=function(){return!n.overwriteDefinition&&f.call(this,e)?i:(t.value=l.call(i,n.resolveContext?n.resolveContext(this):this),p(this,e,t),this[e])},r},e.exports=function(e){var t=i(arguments[1]);return null!=t.resolveContext&&s(t.resolveContext),a(e,function(e,n){return r(n,e,t)})}},function(e,t,n){"use strict";var r=n(118),o=n(32),i=n(2);e.exports=function(e){var t=Object(i(e)),n=arguments[1],s=Object(arguments[2]);if(t!==e&&!n)return t;var a={};return n?r(n,function(t){(s.ensure||t in e)&&(a[t]=e[t])}):o(a,e),a}},function(e,t,n){"use strict";e.exports=n(119)()?Array.from:n(120)},function(e,t,n){"use strict";e.exports=function(){var e,t,n=Array.from;return"function"==typeof n&&(t=n(e=["raz","dwa"]),Boolean(t&&t!==e&&"dwa"===t[1]))}},function(e,t,n){"use strict";var r=n(4).iterator,o=n(21),i=n(121),s=n(51),a=n(3),u=n(2),c=n(7),l=n(22),p=Array.isArray,f=Function.prototype.call,h={configurable:!0,enumerable:!0,writable:!0,value:null},d=Object.defineProperty;e.exports=function(e){var t,n,y,g,m,v,b,_,S,T,w=arguments[1],P=arguments[2];if(e=Object(u(e)),c(w)&&a(w),this&&this!==Array&&i(this))t=this;else{if(!w){if(o(e))return 1!==(m=e.length)?Array.apply(null,e):((g=new Array(1))[0]=e[0],g);if(p(e)){for(g=new Array(m=e.length),n=0;n<m;++n)g[n]=e[n];return g}}g=[]}if(!p(e))if(void 0!==(S=e[r])){for(b=a(S).call(e),t&&(g=new t),_=b.next(),n=0;!_.done;)T=w?f.call(w,P,_.value,n):_.value,t?(h.value=T,d(g,n,h)):g[n]=T,_=b.next(),++n;m=n}else if(l(e)){for(m=e.length,t&&(g=new t),n=0,y=0;n<m;++n)T=e[n],n+1<m&&(v=T.charCodeAt(0))>=55296&&v<=56319&&(T+=e[++n]),T=w?f.call(w,P,T,y):T,t?(h.value=T,d(g,y,h)):g[y]=T,++y;m=y}if(void 0===m)for(m=s(e.length),t&&(g=new t(m)),n=0;n<m;++n)T=w?f.call(w,P,e[n],n):e[n],t?(h.value=T,d(g,n,h)):g[n]=T;return t&&(h.value=null,g.length=m),g}},function(e,t,n){"use strict";var r=Object.prototype.toString,o=r.call(n(50));e.exports=function(e){return"function"==typeof e&&r.call(e)===o}},function(e,t,n){"use strict";var r=n(3),o=n(123),i=Function.prototype.call;e.exports=function(e,t){var n={},s=arguments[2];return r(t),o(e,function(e,r,o,a){n[r]=i.call(t,s,e,r,o,a)}),n}},function(e,t,n){"use strict";e.exports=n(124)("forEach")},function(e,t,n){"use strict";var r=n(3),o=n(2),i=Function.prototype.bind,s=Function.prototype.call,a=Object.keys,u=Object.prototype.propertyIsEnumerable;e.exports=function(e,t){return function(n,c){var l,p=arguments[2],f=arguments[3];return n=Object(o(n)),r(c),l=a(n),f&&l.sort("function"==typeof f?i.call(f,n):void 0),"function"!=typeof e&&(e=l[e]),s.call(e,l,function(e,r){return u.call(n,e)?s.call(c,p,n[e],e,n,r):t})}}},function(e,t,n){"use strict";var r,o=n(20),i=n(6),s=n(4),a=n(33),u=Object.defineProperty;r=e.exports=function(e){if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");e=String(e),a.call(this,e),u(this,"__length__",i("",e.length))},o&&o(r,a),delete r.prototype.constructor,r.prototype=Object.create(a.prototype,{_next:i(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:i(function(e){var t,n=this.__list__[e];return this.__nextIndex__===this.__length__?n:(t=n.charCodeAt(0))>=55296&&t<=56319?n+this.__list__[this.__nextIndex__++]:n})}),u(r.prototype,s.toStringTag,i("c","String Iterator"))},function(e,t,n){"use strict";var r,o=n(20),i=n(6),s=n(33),a=n(4).toStringTag,u=n(127),c=Object.defineProperties,l=s.prototype._unBind;r=e.exports=function(e,t){if(!(this instanceof r))return new r(e,t);s.call(this,e.__mapKeysData__,e),t&&u[t]||(t="key+value"),c(this,{__kind__:i("",t),__values__:i("w",e.__mapValuesData__)})},o&&o(r,s),r.prototype=Object.create(s.prototype,{constructor:i(r),_resolve:i(function(e){return"value"===this.__kind__?this.__values__[e]:"key"===this.__kind__?this.__list__[e]:[this.__list__[e],this.__values__[e]]}),_unBind:i(function(){this.__values__=null,l.call(this)}),toString:i(function(){return"[object Map Iterator]"})}),Object.defineProperty(r.prototype,a,i("c","Map Iterator"))},function(e,t,n){"use strict";e.exports=n(128)("key","value","key+value")},function(e,t,n){"use strict";var r=Array.prototype.forEach,o=Object.create;e.exports=function(e){var t=o(null);return r.call(arguments,function(e){t[e]=!0}),t}},function(e,t,n){"use strict";e.exports="undefined"!=typeof Map&&"[object Map]"===Object.prototype.toString.call(new Map)},,function(e,t,n){"use strict";function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function i(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return g.iterable&&(t[Symbol.iterator]=function(){return t}),t}function s(e){this.map={},e instanceof s?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function a(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function c(e){var t=new FileReader,n=u(t);return t.readAsArrayBuffer(e),n}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:g.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:g.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():g.arrayBuffer&&g.blob&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||v(e))?this._bodyArrayBuffer=l(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(c)}),this.text=function(){var e=a(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=u(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(e,t){var n=(t=t||{}).body;if(e instanceof f){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new s(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new s(t.headers)),this.method=function(e){var t=e.toUpperCase();return b.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function d(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new s(t.headers),this.url=t.url||"",this._initBody(e)}function y(e,t){return new Promise(function(n,r){function o(){a.abort()}var i=new f(e,t);if(i.signal&&i.signal.aborted)return r(new S("Aborted","AbortError"));var a=new XMLHttpRequest;a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:function(e){var t=new s;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t}(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new d(t,e))},a.onerror=function(){r(new TypeError("Network request failed"))},a.ontimeout=function(){r(new TypeError("Network request failed"))},a.onabort=function(){r(new S("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&g.blob&&(a.responseType="blob"),i.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),i.signal&&(i.signal.addEventListener("abort",o),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",o)}),a.send(void 0===i._bodyInit?null:i._bodyInit)})}n.r(t),n(57),n(70),n(81),n(83),n(85);var g={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(g.arrayBuffer)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(e){return e&&m.indexOf(Object.prototype.toString.call(e))>-1};s.prototype.append=function(e,t){e=r(e),t=o(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},s.prototype.delete=function(e){delete this.map[r(e)]},s.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},s.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},s.prototype.set=function(e,t){this.map[r(e)]=o(t)},s.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},s.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),i(e)},s.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),i(e)},s.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),i(e)},g.iterable&&(s.prototype[Symbol.iterator]=s.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},p.call(f.prototype),p.call(d.prototype),d.prototype.clone=function(){return new d(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new s(this.headers),url:this.url})},d.error=function(){var e=new d(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];d.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new d(null,{status:t,headers:{location:e}})};var S=self.DOMException;try{new S}catch(e){(S=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),S.prototype.constructor=S}y.polyfill=!0,self.fetch||(self.fetch=y,self.Headers=s,self.Request=f,self.Response=d)}])})},function(e,t,n){"use strict";(function(e){function r(e,t){function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function i(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})}function s(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&n[0]?i.return:n[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function a(e){if(n.i(b.a)(e))return"";var t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function u(e){var t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata"];return n.i(b.b)(e,r[0])&&"SP.Web"===e[r[0]]?n.i(b.b)(e,r[1])?t.push(e[r[1]]):n.i(b.b)(e,r[2])&&t.push(e.__metadata.uri):n.i(b.b)(e,r[3])&&n.i(b.b)(e,r[1])?t.push(a(e[r[3]]),"_api",e[r[1]]):n.i(b.b)(e,r[1])?t.push("_api",e[r[1]]):n.i(b.b)(e,r[2])&&t.push(e.__metadata.uri),t.length<1?(_.a.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):b.c.apply(void 0,t)}function c(e){return new P(e)}function l(e){return new C(e)}function p(e){b.e.extend(e)}function f(e){return new Promise(function(t){if(n.i(b.i)(e))return t(e);if(null!==I.baseUrl)return t(n.i(b.c)(I.baseUrl,e));if(void 0!==A._spPageContextInfo){if(n.i(b.b)(A._spPageContextInfo,"webAbsoluteUrl"))return t(n.i(b.c)(A._spPageContextInfo.webAbsoluteUrl,e));if(n.i(b.b)(A._spPageContextInfo,"webServerRelativeUrl"))return t(n.i(b.c)(A._spPageContextInfo.webServerRelativeUrl,e))}if(void 0!==A.location){var r=A.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(function(o){var i=r.indexOf(o);if(i>0)return t(n.i(b.c)(r.substr(0,i),e))})}return t(e)})}function h(e){return{__metadata:{type:e}}}function d(e){return function(t){return function(t){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:e)||this}return r(n,t),n}(t)}}function y(e){return e.length<1?1:Math.max.apply(null,e.map(function(e){return e.order}))+1}function g(e){for(var t=0;t<e.length;t++)e[t].order=t+1,n.i(b.b)(e[t],"columns")?g(e[t].columns):n.i(b.b)(e[t],"controls")&&g(e[t].controls)}function m(e){return e.replace(/^(.)/,function(e){return e.toUpperCase()})}function v(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new Proxy({query:Object.assign({Querytext:e},t)},{get:function(e,t,n){var r=t.toString();if("toSearchQuery"===r)return function(){return e.query};if(Dt.has(r))return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=Dt.get(r);return e.query[i.length>0?i:m(r)]=t.length>1?t:t[0],n};var o=Lt.has(r)?Lt.get(r):m(r);return e.query[o]=!0,n}})}Object.defineProperty(t,"__esModule",{value:!0});var b=n(1),_=n(2),S=n(14);n.d(t,"odataUrlFrom",function(){return u}),n.d(t,"spODataEntity",function(){return c}),n.d(t,"spODataEntityArray",function(){return l}),n.d(t,"SharePointQueryable",function(){return U}),n.d(t,"SharePointQueryableInstance",function(){return k}),n.d(t,"SharePointQueryableCollection",function(){return j}),n.d(t,"SharePointQueryableSecurable",function(){return ye}),n.d(t,"FileFolderShared",function(){return be}),n.d(t,"SharePointQueryableShareable",function(){return ge}),n.d(t,"SharePointQueryableShareableFile",function(){return _e}),n.d(t,"SharePointQueryableShareableFolder",function(){return Se}),n.d(t,"SharePointQueryableShareableItem",function(){return ve}),n.d(t,"SharePointQueryableShareableWeb",function(){return me}),n.d(t,"AppCatalog",function(){return pt}),n.d(t,"App",function(){return ft}),n.d(t,"SPBatch",function(){return ht}),n.d(t,"ContentType",function(){return Ne}),n.d(t,"ContentTypes",function(){return Ee}),n.d(t,"FieldLink",function(){return Re}),n.d(t,"FieldLinks",function(){return xe}),n.d(t,"Field",function(){return Fe}),n.d(t,"Fields",function(){return Le}),n.d(t,"CheckinType",function(){return de}),n.d(t,"WebPartsPersonalizationScope",function(){return at}),n.d(t,"MoveOperations",function(){return ut}),n.d(t,"TemplateFileType",function(){return ct}),n.d(t,"File",function(){return ot}),n.d(t,"Files",function(){return rt}),n.d(t,"Folder",function(){return Ie}),n.d(t,"Folders",function(){return Oe}),n.d(t,"SPHttpClient",function(){return R}),n.d(t,"Item",function(){return Ye}),n.d(t,"Items",function(){return Je}),n.d(t,"ItemVersion",function(){return Ze}),n.d(t,"ItemVersions",function(){return $e}),n.d(t,"PagedItemCollection",function(){return et}),n.d(t,"NavigationNodes",function(){return mt}),n.d(t,"NavigationNode",function(){return vt}),n.d(t,"NavigationService",function(){return _t}),n.d(t,"List",function(){return Ve}),n.d(t,"Lists",function(){return Ke}),n.d(t,"RegionalSettings",function(){return Tt}),n.d(t,"InstalledLanguages",function(){return wt}),n.d(t,"TimeZone",function(){return Pt}),n.d(t,"TimeZones",function(){return Ct}),n.d(t,"sp",function(){return sn}),n.d(t,"SPRest",function(){return on}),n.d(t,"RoleDefinitionBindings",function(){return z}),n.d(t,"Search",function(){return Ft}),n.d(t,"SearchQueryBuilder",function(){return v}),n.d(t,"SearchResults",function(){return Bt}),n.d(t,"SortDirection",function(){return Nt}),n.d(t,"ReorderingRuleMatchType",function(){return Mt}),n.d(t,"QueryPropertyValueType",function(){return qt}),n.d(t,"SearchBuiltInSourceId",function(){return Wt}),n.d(t,"SearchSuggest",function(){return Ht}),n.d(t,"Site",function(){return gt}),n.d(t,"UserProfileQuery",function(){return Kt}),n.d(t,"toAbsoluteUrl",function(){return f}),n.d(t,"extractWebUrl",function(){return a}),n.d(t,"UtilityMethod",function(){return tn}),n.d(t,"View",function(){return ke}),n.d(t,"Views",function(){return je}),n.d(t,"ViewFields",function(){return De}),n.d(t,"WebPartDefinitions",function(){return we}),n.d(t,"WebPartDefinition",function(){return Pe}),n.d(t,"WebPart",function(){return Ce}),n.d(t,"Web",function(){return Et}),n.d(t,"SiteScripts",function(){return Zt}),n.d(t,"SiteDesigns",function(){return en}),n.d(t,"HubSite",function(){return rn}),n.d(t,"HubSites",function(){return nn}),n.d(t,"PromotedState",function(){return lt}),n.d(t,"ClientSidePage",function(){return xt}),n.d(t,"CanvasSection",function(){return Rt}),n.d(t,"CanvasColumn",function(){return At}),n.d(t,"ColumnControl",function(){return Ut}),n.d(t,"ClientSideText",function(){return jt}),n.d(t,"ClientSideWebpart",function(){return kt}),n.d(t,"Comments",function(){return ze}),n.d(t,"Comment",function(){return Qe}),n.d(t,"Replies",function(){return Xe}),n.d(t,"SocialQuery",function(){return Qt}),n.d(t,"MySocialQuery",function(){return Xt}),n.d(t,"SocialActorType",function(){return Gt}),n.d(t,"SocialActorTypes",function(){return Jt}),n.d(t,"SocialFollowResult",function(){return Yt}),n.d(t,"SocialStatusCode",function(){return $t}),n.d(t,"ControlMode",function(){return M}),n.d(t,"FieldTypes",function(){return Q}),n.d(t,"DateTimeFieldFormatType",function(){return X}),n.d(t,"DateTimeFieldFriendlyFormatType",function(){return J}),n.d(t,"AddFieldOptions",function(){return Y}),n.d(t,"CalendarType",function(){return $}),n.d(t,"UrlFieldFormatType",function(){return Z}),n.d(t,"PermissionKind",function(){return ee}),n.d(t,"PrincipalType",function(){return te}),n.d(t,"PrincipalSource",function(){return ne}),n.d(t,"RoleType",function(){return re}),n.d(t,"PageType",function(){return oe}),n.d(t,"SharingLinkKind",function(){return ie}),n.d(t,"SharingRole",function(){return se}),n.d(t,"SharingOperationStatusCode",function(){return ae}),n.d(t,"SPSharedObjectType",function(){return ue}),n.d(t,"SharingDomainRestrictionMode",function(){return ce}),n.d(t,"RenderListDataOptions",function(){return le}),n.d(t,"FieldUserSelectionMode",function(){return pe}),n.d(t,"ChoiceFieldFormatType",function(){return fe}),n.d(t,"UrlZone",function(){return he});/**
 * @license
 * v1.3.3
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var T,w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},P=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){var t=new r.factory(u(e),null);return n.i(b.d)(t,e)},r}return r(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){var t=new r.factory(u(e),null);return n.i(b.d)(t,e)})},t}(S.a),C=function(e){function t(t){var r=e.call(this)||this;return r.factory=t,r.hydrate=function(e){return e.map(function(e){var t=new r.factory(u(e),null);return n.i(b.d)(t,e)})},r}return r(t,e),t.prototype.parse=function(t){var r=this;return e.prototype.parse.call(this,t).then(function(e){return e.map(function(e){var t=new r.factory(u(e),null);return n.i(b.d)(t,e)})})},t}(S.a),O=function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=b.e.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){var e=b.e.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==b.e.spfxContext&&null!==b.e.spfxContext?b.e.spfxContext.pageContext.web.absoluteUrl:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=b.e.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:function(){return new b.f}},enumerable:!0,configurable:!0}),e}(),I=new O,E=function(){function e(){}return e}(),N=new Map,x=function(){function e(e,t){void 0===t&&(t=N),this._httpClient=e,this._digests=t}return e.prototype.getDigest=function(e){var t=this,r=this._digests.get(e);if(void 0!==r){if(new Date<r.expiration)return Promise.resolve(r.value)}var o=n.i(b.c)(e,"/_api/contextinfo"),i={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"};return this._httpClient.fetchRaw(o,{cache:"no-cache",credentials:"same-origin",headers:n.i(b.d)(i,I.headers,!0),method:"POST"}).then(function(e){return(new S.b).parse(e).then(function(e){return e.GetContextWebInformation})}).then(function(n){var r=new E;r.value=n.FormDigestValue;var o=n.FormDigestTimeoutSeconds,i=new Date;return i.setTime(i.getTime()+1e3*o),r.expiration=i,t._digests.set(e,r),r.value})},e.prototype.clear=function(){this._digests.clear()},e}(),R=function(){function e(e){void 0===e&&(e=I.fetchClientFactory()),this._impl=e,this._digestCache=new x(this)}return e.prototype.fetch=function(e,t){var r=this;void 0===t&&(t={});var o=n.i(b.d)(t,{cache:"no-cache",credentials:"same-origin"},!0),i=new Headers;return n.i(b.g)(i,I.headers),n.i(b.g)(i,t.headers),i.has("Accept")||i.append("Accept","application/json"),i.has("Content-Type")||i.append("Content-Type","application/json;odata=verbose;charset=utf-8"),i.has("X-ClientService-ClientTag")||i.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.3.3"),i.has("User-Agent")||i.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/1.3.3"),o=n.i(b.d)(o,{headers:i}),!o.method||"GET"===o.method.toUpperCase()||i.has("X-RequestDigest")||i.has("Authorization")?this.fetchRaw(e,o):this._digestCache.getDigest(a(e)).then(function(t){return i.append("X-RequestDigest",t),r.fetchRaw(e,o)})},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var o=new Headers;n.i(b.g)(o,t.headers),t=n.i(b.d)(t,{headers:o});var i=function(o){var s=function(e){var t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=o.delay,o.delay*=2),o.attempts++,o.retryCount<=o.attempts?o.reject(Error("Retry count exceeded ("+o.retryCount+") for request. Response status: ["+e.status+"] "+e.statusText)):setTimeout(n.i(b.h)(r,i,o),t)};r._impl.fetch(e,t).then(function(e){429===e.status?s(e):o.resolve(e)}).catch(function(e){503===e.status?s(e):o.reject(e)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};i.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var r=n.i(b.d)(t,{method:"GET"});return this.fetch(e,r)},e.prototype.post=function(e,t){void 0===t&&(t={});var r=n.i(b.d)(t,{method:"POST"});return this.fetch(e,r)},e.prototype.patch=function(e,t){void 0===t&&(t={});var r=n.i(b.d)(t,{method:"PATCH"});return this.fetch(e,r)},e.prototype.delete=function(e,t){void 0===t&&(t={});var r=n.i(b.d)(t,{method:"DELETE"});return this.fetch(e,r)},e}(),A=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},U=function(e){function t(t,r){var o=e.call(this)||this;if(o._forceCaching=!1,"string"==typeof t)if(n.i(b.i)(t)||t.lastIndexOf("/")<0)o._parentUrl=t,o._url=n.i(b.c)(t,r);else if(t.lastIndexOf("/")>t.lastIndexOf("(")){var i=t.lastIndexOf("/");o._parentUrl=t.slice(0,i),r=n.i(b.c)(t.slice(i),r),o._url=n.i(b.c)(o._parentUrl,r)}else{var i=t.lastIndexOf("(");o._parentUrl=t.slice(0,i),o._url=n.i(b.c)(t,r)}else{o.extend(t,r);var s=t.query.get("@target");void 0!==s&&o.query.set("@target",s)}return o}return r(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return n.i(b.d)(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=new Map(this.query),t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,function(t,n,r){return _.a.write("Rewriting aliased parameter from match "+t+" to label: "+n+" value: "+r,0),e.set(n,"'"+r+"'"),n});if(e.size>0){t+=""+(t.indexOf("?")>-1?"&":"?")+Array.from(e).map(function(e){return e[0]+"="+e[1]}).join("&")}return t},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.getParent=function(e,t,n,r){void 0===t&&(t=this.parentUrl);var o=new e(t,n).configureFrom(this),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),void 0!==r&&(o=o.inBatch(r)),o},t.prototype.clone=function(t,n,r){void 0===r&&(r=!0);var o=e.prototype._clone.call(this,new t(this,n),{includeBatch:r}),i="@target";return this.query.has(i)&&o.query.set(i,this.query.get(i)),o},t.prototype.toRequestContext=function(e,t,r,o){var i=this;void 0===t&&(t={});var s=this.hasBatch?this._batchDependency:function(){};return f(this.toUrlAndQuery()).then(function(a){return n.i(b.j)(t,i._options),{batch:i.batch,batchDependency:s,cachingOptions:i._cachingOptions,clientFactory:function(){return new R},isBatched:i.hasBatch,isCached:i._forceCaching||i._useCaching&&/^get$/i.test(e),options:t,parser:r,pipeline:o,requestAbsoluteUrl:a,requestId:n.i(b.k)(),verb:e}})},t}(S.c),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.skip=function(e){return this.query.set("$skip",e.toString()),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t}(U),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype._update=function(e,t){var r=this;return function(o){return r.postCore({body:n.i(b.l)(n.i(b.d)(h(e),o)),headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return t(e,o)})}},t.prototype._delete=function(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})},t.prototype._deleteWithETag=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t}(U),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){return new F(this,"getById("+e+")")},t.prototype.getByEmail=function(e){return new F(this,"getByEmail('"+e+"')")},t.prototype.getByLoginName=function(e){var t=new F(this);return t.concat("('!@v::"+encodeURIComponent(e)+"')"),t},t.prototype.removeById=function(e){return this.clone(i,"removeById("+e+")").postCore()},t.prototype.removeByLoginName=function(e){var t=this.clone(i,"removeByLoginName(@v)");return t.query.set("@v","'"+encodeURIComponent(e)+"'"),t.postCore()},t.prototype.add=function(e){var t=this;return this.clone(i,null).postCore({body:n.i(b.l)(n.i(b.d)(h("SP.User"),{LoginName:e}))}).then(function(){return t.getByLoginName(e)})};var i;return t=i=o([d("siteusers")],t)}(j),L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new q(this,"groups")},enumerable:!0,configurable:!0}),t}(k),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.User",function(e){return{data:e,user:t}}),t.delete=t._delete,t}return r(t,e),t}(L),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t=o([d("currentuser")],t)}(L);!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(T||(T={}));var M,q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new G(this);return t.concat("("+e+")"),t},t.prototype.add=function(e){var t=this,r=n.i(b.l)(n.i(b.d)(h("SP.Group"),e));return this.postCore({body:r}).then(function(e){return{data:e,group:t.getById(e.Id)}})},t.prototype.getByName=function(e){return new G(this,"getByName('"+e+"')")},t.prototype.removeById=function(e){return this.clone(i,"removeById('"+e+"')").postCore()},t.prototype.removeByLoginName=function(e){return this.clone(i,"removeByLoginName('"+e+"')").postCore()};var i;return t=i=o([d("sitegroups")],t)}(j),G=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.update=r._update("SP.Group",function(e,o){var i=r;return n.i(b.b)(o,"Title")&&(i=r.getParent(t,r.parentUrl,"getByName('"+o.Title+"')")),{data:e,group:i}}),r}return r(t,e),Object.defineProperty(t.prototype,"users",{get:function(){return new D(this,"users")},enumerable:!0,configurable:!0}),t}(k),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getById=function(e){var t=new H(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,t){return this.clone(n,"addroleassignment(principalid="+e+", roledefid="+t+")").postCore()},t.prototype.remove=function(e,t){return this.clone(n,"removeroleassignment(principalid="+e+", roledefid="+t+")").postCore()};var n;return t=n=o([d("roleassignments")],t)}(j),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return r(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new q(this,"groups")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bindings",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),t}(k),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){return new V(this,"getById("+e+")")},t.prototype.getByName=function(e){return new V(this,"getbyname('"+e+"')")},t.prototype.getByType=function(e){return new V(this,"getbytype("+e+")")},t.prototype.add=function(e,t,r,o){var i=this,s=n.i(b.l)({BasePermissions:n.i(b.d)({__metadata:{type:"SP.BasePermissions"}},o),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:s}).then(function(e){return{data:e,definition:i.getById(e.Id)}})},t=o([d("roledefinitions")],t)}(j),V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return r(t,e),t.prototype.update=function(e){var t=this,r=["BasePermissions"];void 0!==n.i(b.b)(e,r[0])&&(e[r[0]]=n.i(b.d)({__metadata:{type:"SP."+r[0]}},e[r[0]]));var o=n.i(b.l)(n.i(b.d)(h("SP.RoleDefinition"),e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(r){var o=t;if(n.i(b.b)(e,"Name")){o=t.getParent(K,t.parentUrl,"").getByName(e.Name)}return{data:r,definition:o}})},t}(k),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t=o([d("roledefinitionbindings")],t)}(j);!function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(M||(M={}));var Q;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(Q||(Q={}));var X;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(X||(X={}));var J;!function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(J||(J={}));var Y;!function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(Y||(Y={}));var $;!function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}($||($={}));var Z;!function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(Z||(Z={}));var ee;!function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(ee||(ee={}));var te;!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(te||(te={}));var ne;!function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(ne||(ne={}));var re;!function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(re||(re={}));var oe;!function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(oe||(oe={}));var ie;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(ie||(ie={}));var se;!function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(se||(se={}));var ae;!function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(ae||(ae={}));var ue;!function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(ue||(ue={}));var ce;!function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(ce||(ce={}));var le;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(le||(le={}));var pe;!function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(pe||(pe={}));var fe;!function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(fe||(fe={}));var he;!function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(he||(he={}));var de,ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"roleAssignments",{get:function(){return new W(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstUniqueAncestorSecurableObject",{get:function(){return new k(this,"FirstUniqueAncestorSecurableObject")},enumerable:!0,configurable:!0}),t.prototype.getUserEffectivePermissions=function(e){var t=this.clone(U,"getUserEffectivePermissions(@user)");return t.query.set("@user","'"+encodeURIComponent(e)+"'"),t.get().then(function(e){return n.i(b.b)(e,"GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e})},t.prototype.getCurrentUserEffectivePermissions=function(){var e=this;return new k("_api/web","currentuser").configureFrom(this).select("LoginName").get().then(function(t){return e.getUserEffectivePermissions(t.LoginName)})},t.prototype.breakRoleInheritance=function(e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.clone(t,"breakroleinheritance(copyroleassignments="+e+", clearsubscopes="+n+")").postCore()},t.prototype.resetRoleInheritance=function(){return this.clone(t,"resetroleinheritance").postCore()},t.prototype.userHasPermissions=function(e,t){var n=this;return this.getUserEffectivePermissions(e).then(function(e){return n.hasPermissions(e,t)})},t.prototype.currentUserHasPermissions=function(e){var t=this;return this.getCurrentUserEffectivePermissions().then(function(n){return t.hasPermissions(n,e)})},t.prototype.hasPermissions=function(e,t){if(!t)return!0;if(t===ee.FullMask)return 32767==(32767&e.High)&&65535===e.Low;t-=1;var n=1;return t>=0&&t<32?(n<<=t,0!=(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!=(e.High&n))},t}(k),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getShareLink=function(e,r){void 0===r&&(r=null);var o=null!==r?r.toISOString():null;return this.clone(t,"shareLink").postCore({body:n.i(b.l)({request:{createLink:!0,emailData:null,settings:{expiration:o,linkKind:e}}})})},t.prototype.shareWith=function(e,r,o,i,s){var a=this;void 0===o&&(o=!1),void 0===i&&(i=!1),Array.isArray(e)||(e=[e]);var u=n.i(b.l)(e.map(function(e){return{Key:e}})),c=r===se.Edit?re.Contributor:re.Reader;return new j("_api/web","roledefinitions").select("Id").filter("RoleTypeKind eq "+c).get().then(function(e){if(!Array.isArray(e)||e.length<1)throw Error("Could not locate a role defintion with RoleTypeKind "+c);var r={includeAnonymousLinkInEmail:o,peoplePickerInput:u,propagateAcl:i,roleValue:"role:"+e[0].Id,useSimplifiedRoles:!0};return void 0!==s&&(r=n.i(b.d)(r,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),a.clone(t,"shareObject").postCore({body:n.i(b.l)(r)})})},t.prototype.shareObject=function(e,t){var r=this;return void 0===t&&(t=!1),t?this.sendShareObjectRequest(e):(e=n.i(b.d)(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(function(t){Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);var o=n.i(b.l)(e.loginNames.map(function(e){return{Key:e}})),i={peoplePickerInput:o,roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(i=n.i(b.d)(i,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),r.sendShareObjectRequest(i)}))},t.prototype.unshareObjectWeb=function(e){return this.clone(t,"unshareObject").postCore({body:n.i(b.l)({url:e})})},t.prototype.checkPermissions=function(e){return this.clone(t,"checkPermissions").postCore({body:n.i(b.l)({recipients:e})})},t.prototype.getSharingInformation=function(e,r){void 0===e&&(e=null);var o=this.clone(t,"getSharingInformation");return o.expand.apply(o,r).postCore({body:n.i(b.l)({request:e})})},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(t,"getObjectSharingSettings").postCore({body:n.i(b.l)({useSimplifiedRoles:e})})},t.prototype.unshareObject=function(){return this.clone(t,"unshareObject").postCore()},t.prototype.deleteLinkByKind=function(e){return this.clone(t,"deleteLinkByKind").postCore({body:n.i(b.l)({linkKind:e})})},t.prototype.unshareLink=function(e,r){return void 0===r&&(r="00000000-0000-0000-0000-000000000000"),this.clone(t,"unshareLink").postCore({body:n.i(b.l)({linkKind:e,shareId:r})})},t.prototype.getRoleValue=function(e,t){if(void 0===t||null===t){var n=e===se.Edit?re.Contributor:re.Reader;return new j("_api/web","roledefinitions").select("Id").top(1).filter("RoleTypeKind eq "+n).get().then(function(e){if(e.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return"role: "+e[0].Id})}switch(t){case re.Contributor:return new k("_api/web","associatedmembergroup").select("Id").get().then(function(e){return"group: "+e.Id});case re.Reader:case re.Guest:return new k("_api/web","associatedvisitorgroup").select("Id").get().then(function(e){return"group: "+e.Id});default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}},t.prototype.getShareObjectWeb=function(e){return Promise.resolve(new k(a(e),"/_api/SP.Web.ShareObject"))},t.prototype.sendShareObjectRequest=function(e){return this.getShareObjectWeb(this.toUrl()).then(function(r){return r.expand("UsersWithAccessRequests","GroupsSharedWith").as(t).postCore({body:n.i(b.l)(e)})})},t}(U),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.shareWith=function(e,t,r){var o=this;void 0===t&&(t=se.View);var i=this.addBatchDependency();return new k(a(this.toUrl()),"/_api/web/url").get().then(function(s){return i(),o.shareObject(n.i(b.c)(s,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)})},t.prototype.shareObject=function(e,t,n,r,o,i,s,a){return void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!0),this.clone(ge,null).shareObject({emailData:r,group:o,includeAnonymousLinkInEmail:s,loginNames:t,propagateAcl:i,role:n,url:e,useSimplifiedRoles:a})},t.prototype.shareObjectRaw=function(e){return this.clone(ge,null).shareObject(e,!0)},t.prototype.unshareObject=function(e){return this.clone(ge,null).unshareObjectWeb(e)},t}(ye),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getShareLink=function(e,t){return void 0===e&&(e=ie.OrganizationView),void 0===t&&(t=null),this.clone(ge,null).getShareLink(e,t)},t.prototype.shareWith=function(e,t,n,r){return void 0===t&&(t=se.View),void 0===n&&(n=!1),this.clone(ge,null).shareWith(e,t,n,!1,r)},t.prototype.checkSharingPermissions=function(e){return this.clone(ge,null).checkPermissions(e)},t.prototype.getSharingInformation=function(e,t){return void 0===e&&(e=null),this.clone(ge,null).getSharingInformation(e,t)},t.prototype.getObjectSharingSettings=function(e){return void 0===e&&(e=!0),this.clone(ge,null).getObjectSharingSettings(e)},t.prototype.unshare=function(){return this.clone(ge,null).unshareObject()},t.prototype.deleteSharingLinkByKind=function(e){return this.clone(ge,null).deleteLinkByKind(e)},t.prototype.unshareLink=function(e,t){return this.clone(ge,null).unshareLink(e,t)},t}(ye),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getShareLink=function(e,t){void 0===e&&(e=ie.OrganizationView),void 0===t&&(t=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getShareLink(e,t)})},t.prototype.checkSharingPermissions=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.checkPermissions(e)})},t.prototype.getSharingInformation=function(e,t){void 0===e&&(e=null);var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.getSharingInformation(e,t)})},t.prototype.getObjectSharingSettings=function(e){void 0===e&&(e=!0);var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.getObjectSharingSettings(e)})},t.prototype.unshare=function(){var e=this.addBatchDependency();return this.getShareable().then(function(t){return e(),t.unshareObject()})},t.prototype.deleteSharingLinkByKind=function(e){var t=this.addBatchDependency();return this.getShareable().then(function(n){return t(),n.deleteLinkByKind(e)})},t.prototype.unshareLink=function(e,t){var n=this.addBatchDependency();return this.getShareable().then(function(r){return n(),r.unshareLink(e,t)})},t.prototype.getShareable=function(){var e=this;return this.clone(_e,"listItemAllFields",!1).select("odata.id").get().then(function(t){var n=new ge(u(t));return e.hasBatch&&(n=n.inBatch(e.batch)),n})},t}(k),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.shareWith=function(e,t,n,r){void 0===t&&(t=se.View),void 0===n&&(n=!1);var o=this.addBatchDependency();return this.getShareable().then(function(i){return o(),i.shareWith(e,t,n,!1,r)})},t}(be),Se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.shareWith=function(e,t,n,r,o){void 0===t&&(t=se.View),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.addBatchDependency();return this.getShareable().then(function(s){return i(),s.shareWith(e,t,n,r,o)})},t}(be),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"webparts",{get:function(){return new we(this,"webparts")},enumerable:!0,configurable:!0}),t.prototype.export=function(e){return this.clone(t,"ExportWebPart").postCore({body:n.i(b.l)({webPartId:e})})},t.prototype.import=function(e){return this.clone(t,"ImportWebPart").postCore({body:n.i(b.l)({webPartXml:e})})},t}(U),we=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){return new Pe(this,"getbyid('"+e+"')")},t.prototype.getByControlId=function(e){return new Pe(this,"getByControlId('"+e+"')")},t}(j),Pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"webpart",{get:function(){return new Ce(this)},enumerable:!0,configurable:!0}),t.prototype.saveChanges=function(){return this.clone(t,"SaveWebPartChanges").postCore()},t.prototype.moveTo=function(e,n){return this.clone(t,"MoveWebPartTo(zoneID='"+e+"', zoneIndex="+n+")").postCore()},t.prototype.close=function(){return this.clone(t,"CloseWebPart").postCore()},t.prototype.open=function(){return this.clone(t,"OpenWebPart").postCore()},t.prototype.delete=function(){return this.clone(t,"DeleteWebPart").postCore()},t}(k),Ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t=o([d("webpart")],t)}(k),Oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getByName=function(e){var t=new Ie(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this;return this.clone(n,"add('"+e+"')").postCore().then(function(n){return{data:n,folder:t.getByName(e)}})};var n;return t=n=o([d("folders")],t)}(j),Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.Folder",function(e){return{data:e,folder:t}}),t}return r(t,e),Object.defineProperty(t.prototype,"contentTypeOrder",{get:function(){return new j(this,"contentTypeOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"files",{get:function(){return new rt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new k(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentFolder",{get:function(){return new t(this,"parentFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return new k(this,"properties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverRelativeUrl",{get:function(){return new U(this,"serverRelativeUrl")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uniqueContentTypeOrder",{get:function(){return new j(this,"uniqueContentTypeOrder")},enumerable:!0,configurable:!0}),t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getItem=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.listItemAllFields;return r.select.apply(r,e).get().then(function(e){return n.i(b.d)(new Ye(u(e)),e)})},t.prototype.moveTo=function(e){var t=this;return this.select("ServerRelativeUrl").get().then(function(r){var o=r.ServerRelativeUrl,i=new R,s=t.toUrl().split("/_api")[0],a=s.replace("://","___").split("/")[0].replace("___","://"),u=s+"/_api/SP.MoveCopyUtil.MoveFolder()";return i.post(u,{body:n.i(b.l)({destUrl:0===e.indexOf("http")?e:""+a+e,srcUrl:""+a+o})}).then(function(e){return e.json()})})},t}(Se),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.addAvailableContentType=function(e){var t=this,r=n.i(b.l)({contentTypeId:e});return this.clone(i,"addAvailableContentType").postCore({body:r}).then(function(e){return{contentType:t.getById(e.id),data:e}})},t.prototype.getById=function(e){var t=new Ne(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r,o,i){var s=this;void 0===r&&(r=""),void 0===o&&(o="Custom Content Types"),void 0===i&&(i={});var a=n.i(b.l)(Object.assign(h("SP.ContentType"),{Description:r,Group:o,Id:{StringValue:e},Name:t},i));return this.postCore({body:a}).then(function(e){return{contentType:s.getById(e.id),data:e}})};var i;return t=i=o([d("contenttypes")],t)}(j),Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return r(t,e),Object.defineProperty(t.prototype,"fieldLinks",{get:function(){return new xe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new j(this,"fields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new t(this,"parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"workflowAssociations",{get:function(){return new j(this,"workflowAssociations")},enumerable:!0,configurable:!0}),t}(k),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){var t=new Re(this);return t.concat("(guid'"+e+"')"),t},t=o([d("fieldlinks")],t)}(j),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(k),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getByName=function(e){var t=new Ue(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t){var r=this;return this.clone(n,"add(FileName='"+e+"')",!1).postCore({body:t}).then(function(t){return{data:t,file:r.getByName(e)}})},t.prototype.addMultiple=function(e){var t=this;return e.reduce(function(e,r){return e.then(function(){return t.clone(n,"add(FileName='"+r.name+"')",!1).postCore({body:r.content})})},Promise.resolve())},t.prototype.deleteMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).delete()})},Promise.resolve())},t.prototype.recycleMultiple=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.reduce(function(t,n){return t.then(function(){return e.getByName(n).recycle()})},Promise.resolve())};var n;return t=n=o([d("AttachmentFiles")],t)}(j),Ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return r(t,e),t.prototype.getText=function(){return this.getParsed(new S.d)},t.prototype.getBlob=function(){return this.getParsed(new S.e)},t.prototype.getBuffer=function(){return this.getParsed(new S.f)},t.prototype.getJSON=function(){return this.getParsed(new S.g)},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.recycle=function(e){return void 0===e&&(e="*"),this.clone(t,"recycleObject").postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getParsed=function(e){return this.clone(t,"$value",!1).get(e)},t}(k),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new ke(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new ke(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,r){var o=this;void 0===t&&(t=!1),void 0===r&&(r={});var s=n.i(b.l)(Object.assign(h("SP.View"),{PersonalView:t,Title:e},r));return this.clone(i,null).postCore({body:s}).then(function(e){return{data:e,view:o.getById(e.Id)}})};var i;return t=i=o([d("views")],t)}(j),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.View",function(e){return{data:e,view:t}}),t.delete=t._delete,t}return r(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return new De(this)},enumerable:!0,configurable:!0}),t.prototype.renderAsHtml=function(){return this.clone(U,"renderashtml").get()},t.prototype.setViewXml=function(e){return this.clone(t,"SetViewXml").postCore({body:n.i(b.l)({viewXml:e})})},t}(k),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getSchemaXml=function(){return this.clone(U,"schemaxml").get()},t.prototype.add=function(e){return this.clone(i,"addviewfield('"+e+"')").postCore()},t.prototype.move=function(e,t){return this.clone(i,"moveviewfieldto").postCore({body:n.i(b.l)({field:e,index:t})})},t.prototype.removeAll=function(){return this.clone(i,"removeallviewfields").postCore()},t.prototype.remove=function(e){return this.clone(i,"removeviewfield('"+e+"')").postCore()};var i;return t=i=o([d("viewfields")],t)}(j),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new Fe(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new Fe(this,"getByTitle('"+e+"')")},t.prototype.getByInternalNameOrTitle=function(e){return new Fe(this,"getByInternalNameOrTitle('"+e+"')")},t.prototype.createFieldAsXml=function(e){var t,r=this;t="string"==typeof e?{SchemaXml:e}:e;var o=n.i(b.l)({parameters:n.i(b.d)(h("SP.XmlSchemaFieldCreationInformation"),t)});return this.clone(i,"createfieldasxml").postCore({body:o}).then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.add=function(e,t,r){var o=this,s=n.i(b.l)(Object.assign(h(t),{Title:e},r));return this.clone(i,null).postCore({body:s}).then(function(e){return{data:e,field:o.getById(e.Id)}})},t.prototype.addText=function(e,t,r){void 0===t&&(t=255);var o={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",n.i(b.d)(o,r))},t.prototype.addCalculated=function(e,t,r,o,i){void 0===o&&(o=Q.Text);var s={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:o};return this.add(e,"SP.FieldCalculated",n.i(b.d)(s,i))},t.prototype.addDateTime=function(e,t,r,o,i){void 0===t&&(t=X.DateOnly),void 0===r&&(r=$.Gregorian),void 0===o&&(o=J.Unspecified);var s={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:o};return this.add(e,"SP.FieldDateTime",n.i(b.d)(s,i))},t.prototype.addNumber=function(e,t,r,o){var i={FieldTypeKind:9};return void 0!==t&&(i=n.i(b.d)({MinimumValue:t},i)),void 0!==r&&(i=n.i(b.d)({MaximumValue:r},i)),this.add(e,"SP.FieldNumber",n.i(b.d)(i,o))},t.prototype.addCurrency=function(e,t,r,o,i){void 0===o&&(o=1033);var s={CurrencyLocaleId:o,FieldTypeKind:10};return void 0!==t&&(s=n.i(b.d)({MinimumValue:t},s)),void 0!==r&&(s=n.i(b.d)({MaximumValue:r},s)),this.add(e,"SP.FieldCurrency",n.i(b.d)(s,i))},t.prototype.addMultilineText=function(e,t,r,o,i,s,a){void 0===t&&(t=6),void 0===r&&(r=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===s&&(s=!0);var u={AllowHyperlink:s,AppendOnly:i,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:o,RichText:r};return this.add(e,"SP.FieldMultiLineText",n.i(b.d)(u,a))},t.prototype.addUrl=function(e,t,r){void 0===t&&(t=Z.Hyperlink);var o={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",n.i(b.d)(o,r))},t.prototype.addUser=function(e,t,r){var o={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",n.i(b.d)(o,r))},t.prototype.addLookup=function(e,t,r,o){var s=this,a=n.i(b.d)({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},o),u=n.i(b.l)({parameters:n.i(b.d)(h("SP.FieldCreationInformation"),a)});return this.clone(i,"addfield").postCore({body:u}).then(function(e){return{data:e,field:s.getById(e.Id)}})},t.prototype.addChoice=function(e,t,r,o,i){void 0===r&&(r=fe.Dropdown);var s={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:o};return this.add(e,"SP.FieldChoice",n.i(b.d)(s,i))},t.prototype.addMultiChoice=function(e,t,r,o){var i={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",n.i(b.d)(i,o))},t.prototype.addBoolean=function(e,t){var r={FieldTypeKind:8};return this.add(e,"SP.Field",n.i(b.d)(r,t))},t.prototype.addDependentLookupField=function(e,t,n){var r=this;return this.clone(i,"adddependentlookupfield(displayName='"+e+"', primarylookupfieldid='"+t+"', showfield='"+n+"')").postCore().then(function(e){return{data:e,field:r.getById(e.Id)}})},t.prototype.addLocation=function(e,t){var r={FieldTypeKind:33};return this.add(e,"SP.FieldLocation",n.i(b.d)(r,t))};var i;return t=i=o([d("fields")],t)}(j),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._delete,t}return r(t,e),t.prototype.update=function(e,t){var r=this;void 0===t&&(t="SP.Field");var o=n.i(b.l)(n.i(b.d)(h(t),e));return this.postCore({body:o,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,field:r}})},t.prototype.setShowInDisplayForm=function(e){return this.clone(t,"setshowindisplayform("+e+")").postCore()},t.prototype.setShowInEditForm=function(e){return this.clone(t,"setshowineditform("+e+")").postCore()},t.prototype.setShowInNewForm=function(e){return this.clone(t,"setshowinnewform("+e+")").postCore()},t}(k),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){var t=new Me(this);return t.concat("('"+e+"')"),t},t=o([d("forms")],t)}(j),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(k),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){var t=new Ge(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var o=this,i={expirationDateTime:t,notificationUrl:e,resource:this.toUrl()};return r&&(i.clientState=r),this.postCore({body:n.i(b.l)(i),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:o.getById(e.id)}})},t=o([d("subscriptions")],t)}(j),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.update=function(e,t,r){var o=this,i={};return e&&(i.expirationDateTime=e),t&&(i.notificationUrl=t),r&&(i.clientState=r),this.patchCore({body:n.i(b.l)(i),headers:{"Content-Type":"application/json"}}).then(function(e){return{data:e,subscription:o}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(k),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new He(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e){var t=this,r=n.i(b.l)(n.i(b.d)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:r}).then(function(e){return{action:t.getById(e.Id),data:e}})},t.prototype.clear=function(){return this.clone(i,"clear").postCore()};var i;return t=i=o([d("usercustomactions")],t)}(j),He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.update=t._update("SP.UserCustomAction",function(e){return{data:e,action:t}}),t}return r(t,e),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t}(k),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new Ve(this);return t.concat("('"+e+"')"),t},t.prototype.getByTitle=function(e){return new Ve(this,"getByTitle('"+e+"')")},t.prototype.add=function(e,t,r,o,i){var s=this;void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={});var a=n.i(b.d)({AllowContentTypes:o,BaseTemplate:r,ContentTypesEnabled:o,Description:t,Title:e,__metadata:{type:"SP.List"}},i);return this.postCore({body:n.i(b.l)(a)}).then(function(e){return{data:e,list:s.getByTitle(a.Title)}})},t.prototype.ensure=function(e,t,r,o,i){var s=this;if(void 0===t&&(t=""),void 0===r&&(r=100),void 0===o&&(o=!1),void 0===i&&(i={}),this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");return new Promise(function(a,u){var c=n.i(b.d)(i,{Title:e,Description:t,ContentTypesEnabled:o},!0),l=s.getByTitle(c.Title);l.get().then(function(e){l.update(c).then(function(e){a({created:!1,data:e,list:s.getByTitle(c.Title)})}).catch(function(e){return u(e)})}).catch(function(n){s.add(e,t,r,o,c).then(function(e){a({created:!0,data:e.data,list:s.getByTitle(c.Title)})}).catch(function(e){return u(e)})})})},t.prototype.ensureSiteAssetsLibrary=function(){return this.clone(i,"ensuresiteassetslibrary").postCore().then(function(e){return new Ve(u(e))})},t.prototype.ensureSitePagesLibrary=function(){return this.clone(i,"ensuresitepageslibrary").postCore().then(function(e){return new Ve(u(e))})};var i;return t=i=o([d("lists")],t)}(j),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return new Je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"views",{get:function(){return new je(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"forms",{get:function(){return new Be(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultView",{get:function(){return new ke(this,"DefaultView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new U(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventReceivers",{get:function(){return new j(this,"EventReceivers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedFields",{get:function(){return new U(this,"getRelatedFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"informationRightsManagementSettings",{get:function(){return new U(this,"InformationRightsManagementSettings")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subscriptions",{get:function(){return new qe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new Ie(this,"rootFolder")},enumerable:!0,configurable:!0}),t.prototype.getView=function(e){return new ke(this,"getView('"+e+"')")},t.prototype.update=function(e,r){var o=this;void 0===r&&(r="*");var i=n.i(b.l)(n.i(b.d)({__metadata:{type:"SP.List"}},e));return this.postCore({body:i,headers:{"IF-Match":r,"X-HTTP-Method":"MERGE"}}).then(function(r){var i=o;return n.i(b.b)(e,"Title")&&(i=o.getParent(t,o.parentUrl,"getByTitle('"+e.Title+"')")),{data:r,list:i}})},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.getChanges=function(e){return this.clone(t,"getchanges").postCore({body:n.i(b.l)({query:n.i(b.d)(h("SP.ChangeQuery"),e)})})},t.prototype.getItemsByCAMLQuery=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var i=this.clone(t,"getitems");return i.expand.apply(i,r).postCore({body:n.i(b.l)({query:n.i(b.d)({__metadata:{type:"SP.CamlQuery"}},e)})})},t.prototype.getListItemChangesSinceToken=function(e){return this.clone(t,"getlistitemchangessincetoken").postCore({body:n.i(b.l)({query:n.i(b.d)({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:function(e){return e.text()}})},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore().then(function(e){return n.i(b.b)(e,"Recycle")?e.Recycle:e})},t.prototype.renderListData=function(e){var r=this.clone(t,"renderlistdata(@viewXml)");return r.query.set("@viewXml","'"+e+"'"),r.postCore().then(function(e){return JSON.parse(n.i(b.b)(e,"RenderListData")?e.RenderListData:e)})},t.prototype.renderListDataAsStream=function(e,r){void 0===r&&(r=null);var o={overrideParameters:n.i(b.d)(h("SP.RenderListDataOverrideParameters"),r),parameters:n.i(b.d)(h("SP.RenderListDataParameters"),e)};return this.clone(t,"RenderListDataAsStream",!0).postCore({body:n.i(b.l)(o)})},t.prototype.renderListFormData=function(e,r,o){return this.clone(t,"renderlistformdata(itemid="+e+", formid='"+r+"', mode='"+o+"')").postCore().then(function(e){return JSON.parse(n.i(b.b)(e,"RenderListFormData")?e.RenderListFormData:e)})},t.prototype.reserveListItemId=function(){return this.clone(t,"reservelistitemid").postCore().then(function(e){return n.i(b.b)(e,"ReserveListItemId")?e.ReserveListItemId:e})},t.prototype.getListItemEntityTypeFullName=function(){return this.clone(t,null,!1).select("ListItemEntityTypeFullName").get().then(function(e){return e.ListItemEntityTypeFullName})},t.prototype.addValidateUpdateItemUsingPath=function(e,r,o,i){return void 0===o&&(o=!1),this.clone(t,"AddValidateUpdateItemUsingPath()").postCore({body:n.i(b.l)({bNewDocumentUpdate:o,checkInComment:i,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:r,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}})}).then(function(e){return void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e})},t}(ye),ze=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.add=function(e){var t=this;"string"==typeof e&&(e={text:e});var r=n.i(b.l)(n.i(b.d)(h("Microsoft.SharePoint.Comments.comment"),e));return this.clone(i,null).postCore({body:r}).then(function(e){return n.i(b.d)(t.getById(e.id),e)})},t.prototype.getById=function(e){var t=new Qe(this);return t.concat("("+e+")"),t},t.prototype.clear=function(){return this.clone(i,"DeleteAll").postCore()};var i;return t=i=o([d("comments")],t)}(j),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"replies",{get:function(){return new Xe(this)},enumerable:!0,configurable:!0}),t.prototype.like=function(){return this.clone(t,"Like").postCore()},t.prototype.unlike=function(){return this.clone(t,"Unlike").postCore()},t.prototype.delete=function(){return this.deleteCore()},t}(k),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.add=function(e){"string"==typeof e&&(e={text:e});var t=n.i(b.l)(n.i(b.d)(h("Microsoft.SharePoint.Comments.comment"),e));return this.clone(i,null).postCore({body:t}).then(function(e){return n.i(b.d)(new Qe(u(e)),e)})};var i;return t=i=o([d("replies")],t)}(j),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.getById=function(e){var t=new Ye(this);return t.concat("("+e+")"),t},t.prototype.getItemByStringId=function(e){return new Ye(this.parentUrl,"getItemByStringId('"+e+"')")},t.prototype.skip=function(e,t){return void 0===t&&(t=!1),t?this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&PagedPrev=TRUE&p_ID="+e)):this.query.set("$skiptoken",encodeURIComponent("Paged=TRUE&p_ID="+e)),this},t.prototype.getPaged=function(){return this.get(new tt(this))},t.prototype.getAll=function(e,t){void 0===e&&(e=2e3),void 0===t&&(t="application/json;odata=nometadata"),_.a.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);var n=new i(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach(function(e,t){/^\$select|filter|top|expand$/i.test(t)&&n.query.set(t,e)}),new Promise(function(e,t){var r=[],o=function(n){[].push.apply(r,n.results),n.hasNext?n.getNext().then(o).catch(t):e(r)};n.getPaged().then(o).catch(t)})},t.prototype.add=function(e,t){var r=this;void 0===e&&(e={}),void 0===t&&(t=null);var o=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(function(t){var s=n.i(b.l)(n.i(b.d)(h(t),e)),a=r.clone(i,"").postCore({body:s}).then(function(e){return{data:e,item:r.getById(e.Id)}});return o(),a})},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.getParent(Ve).getListItemEntityTypeFullName()};var i;return t=i=o([d("items")],t)}(j),Ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return r(t,e),Object.defineProperty(t.prototype,"attachmentFiles",{get:function(){return new Ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentType",{get:function(){return new Ne(this,"ContentType")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"comments",{get:function(){return new ze(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissions",{get:function(){return new U(this,"EffectiveBasePermissions")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effectiveBasePermissionsForUI",{get:function(){return new U(this,"EffectiveBasePermissionsForUI")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsHTML",{get:function(){return new k(this,"FieldValuesAsHTML")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesAsText",{get:function(){return new k(this,"FieldValuesAsText")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldValuesForEdit",{get:function(){return new k(this,"FieldValuesForEdit")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folder",{get:function(){return new Ie(this,"folder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return new ot(this,"file")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new $e(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this.getParent(Ve,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/")))},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t,r){var o=this;return void 0===t&&(t="*"),void 0===r&&(r=null),new Promise(function(i,s){var a=o.addBatchDependency();return o.ensureListItemEntityTypeName(r).then(function(r){var s=n.i(b.l)(n.i(b.d)(h(r),e));return a(),o.postCore({body:s,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new nt).then(function(e){i({data:e,item:o})})}).catch(function(e){return s(e)})})},t.prototype.getLikedBy=function(){return this.clone(t,"likedBy").postCore()},t.prototype.like=function(){return this.clone(t,"like").postCore()},t.prototype.unlike=function(){return this.clone(t,"unlike").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.getWopiFrameUrl=function(e){void 0===e&&(e=0);var r=this.clone(t,"getWOPIFrameUrl(@action)");return r.query.set("@action",e),r.postCore().then(function(e){return n.i(b.b)(e,"GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e})},t.prototype.validateUpdateListItem=function(e,r){return void 0===r&&(r=!1),this.clone(t,"validateupdatelistitem").postCore({body:n.i(b.l)({formValues:e,bNewDocumentUpdate:r})})},t.prototype.getLikedByInformation=function(){return this.clone(t,"likedByInformation").expand("likedby").getCore()},t.prototype.ensureListItemEntityTypeName=function(e){return e?Promise.resolve(e):this.list.getListItemEntityTypeFullName()},t}(ve),$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){var t=new Ze(this);return t.concat("("+e+")"),t},t=o([d("versions")],t)}(j),Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return r(t,e),t}(k),et=function(){function e(e,t,n){this.parent=e,this.nextUrl=t,this.results=n}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0},enumerable:!0,configurable:!0}),e.prototype.getNext=function(){if(this.hasNext){return new Je(this.nextUrl,null).configureFrom(this.parent).getPaged()}return new Promise(function(e){return e(null)})},e}(),tt=function(e){function t(t){var n=e.call(this)||this;return n._parent=t,n}return r(t,e),t.prototype.parse=function(e){var t=this;return new Promise(function(r,o){t.handleError(e,o)&&e.json().then(function(e){var o=n.i(b.b)(e,"d")&&n.i(b.b)(e.d,"__next")?e.d.__next:e["odata.nextLink"];r(new et(t._parent,o,t.parseODataJSON(e)))})})},t}(S.a),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parse=function(e){return i(this,void 0,void 0,function(){var t=this;return s(this,function(n){return[2,new Promise(function(n,r){t.handleError(e,r)&&n({"odata.etag":e.headers.get("etag")})})]})})},t}(S.a),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getByName=function(e){var t=new ot(this);return t.concat("('"+e+"')"),t},t.prototype.add=function(e,t,r){var o=this;return void 0===r&&(r=!0),new n(this,"add(overwrite="+r+",url='"+e+"')").postCore({body:t}).then(function(t){return{data:t,file:o.getByName(e)}})},t.prototype.addChunked=function(e,t,r,o,i){var s=this;return void 0===o&&(o=!0),void 0===i&&(i=10485760),this.clone(n,"add(overwrite="+o+",url='"+e+"')",!1).postCore().then(function(){return s.getByName(e)}).then(function(e){return e.setContentChunked(t,r,i)})},t.prototype.addTemplateFile=function(e,t){var r=this;return this.clone(n,"addTemplateFile(urloffile='"+e+"',templatefiletype="+t+")",!1).postCore().then(function(t){return{data:t,file:r.getByName(e)}})};var n;return t=n=o([d("files")],t)}(j),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"listItemAllFields",{get:function(){return new k(this,"listItemAllFields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versions",{get:function(){return new it(this)},enumerable:!0,configurable:!0}),t.prototype.approve=function(e){return void 0===e&&(e=""),this.clone(t,"approve(comment='"+e+"')").postCore()},t.prototype.cancelUpload=function(e){return this.clone(t,"cancelUpload(uploadId=guid'"+e+"')",!1).postCore()},t.prototype.checkin=function(e,n){if(void 0===e&&(e=""),void 0===n&&(n=de.Major),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"checkin(comment='"+e+"',checkintype="+n+")").postCore()},t.prototype.checkout=function(){return this.clone(t,"checkout").postCore()},t.prototype.copyTo=function(e,n){return void 0===n&&(n=!0),this.clone(t,"copyTo(strnewurl='"+e+"',boverwrite="+n+")").postCore()},t.prototype.delete=function(e){return void 0===e&&(e="*"),this.clone(t,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})},t.prototype.deny=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"deny(comment='"+e+"')").postCore()},t.prototype.getLimitedWebPartManager=function(e){return void 0===e&&(e=at.Shared),new Te(this,"getLimitedWebPartManager(scope="+e+")")},t.prototype.moveTo=function(e,n){return void 0===n&&(n=ut.Overwrite),this.clone(t,"moveTo(newurl='"+e+"',flags="+n+")").postCore()},t.prototype.publish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"publish(comment='"+e+"')").postCore()},t.prototype.recycle=function(){return this.clone(t,"recycle").postCore()},t.prototype.undoCheckout=function(){return this.clone(t,"undoCheckout").postCore()},t.prototype.unpublish=function(e){if(void 0===e&&(e=""),e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(t,"unpublish(comment='"+e+"')").postCore()},t.prototype.getText=function(){return this.clone(t,"$value",!1).get(new S.d,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new S.e,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new S.f,{headers:{binaryStringResponseBody:"true"}})},t.prototype.getJSON=function(){return this.clone(t,"$value",!1).get(new S.g,{headers:{binaryStringResponseBody:"true"}})},t.prototype.setContent=function(e){var n=this;return this.clone(t,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(function(e){return new t(n)})},t.prototype.getItem=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=this.listItemAllFields;return o.select.apply(o,t).get().then(function(t){return n.i(b.d)(new Ye(u(t)).configureFrom(e),t)})},t.prototype.setContentChunked=function(e,t,r){var o=this;void 0===r&&(r=10485760),void 0===t&&(t=function(){return null});var i=e.size,s=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),a=n.i(b.k)();t({uploadId:a,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:i,stage:"starting",totalBlocks:s});for(var u=this.startUpload(a,e.slice(0,r)),c=function(n){u=u.then(function(u){return t({uploadId:a,blockNumber:n,chunkSize:r,currentPointer:u,fileSize:i,stage:"continue",totalBlocks:s}),o.continueUpload(a,u,e.slice(u,u+r))})},l=2;l<s;l++)c(l);return u.then(function(n){return t({uploadId:a,blockNumber:s,chunkSize:r,currentPointer:n,fileSize:i,stage:"finishing",totalBlocks:s}),o.finishUpload(a,n,e.slice(n))})},t.prototype.startUpload=function(e,n){return this.clone(t,"startUpload(uploadId=guid'"+e+"')",!1).postCore({body:n}).then(function(e){return"object"==typeof e&&(e=e.StartUpload),parseFloat(e)})},t.prototype.continueUpload=function(e,n,r){return this.clone(t,"continueUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return"object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)})},t.prototype.finishUpload=function(e,n,r){return this.clone(t,"finishUpload(uploadId=guid'"+e+"',fileOffset="+n+")",!1).postCore({body:r}).then(function(e){return{data:e,file:new t(u(e))}})},t}(_e),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getById=function(e){var t=new st(this);return t.concat("("+e+")"),t},t.prototype.deleteAll=function(){return new n(this,"deleteAll").postCore()},t.prototype.deleteById=function(e){return this.clone(n,"deleteById(vid="+e+")").postCore()},t.prototype.recycleByID=function(e){return this.clone(n,"recycleByID(vid="+e+")").postCore()},t.prototype.deleteByLabel=function(e){return this.clone(n,"deleteByLabel(versionlabel='"+e+"')").postCore()},t.prototype.recycleByLabel=function(e){return this.clone(n,"recycleByLabel(versionlabel='"+e+"')").postCore()},t.prototype.restoreByLabel=function(e){return this.clone(n,"restoreByLabel(versionlabel='"+e+"')").postCore()};var n;return t=n=o([d("versions")],t)}(j),st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delete=t._deleteWithETag,t}return r(t,e),t}(k);!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(de||(de={}));var at;!function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(at||(at={}));var ut;!function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(ut||(ut={}));var ct;!function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(ct||(ct={}));var lt,pt=function(e){function t(t,n){return void 0===n&&(n="_api/web/tenantappcatalog/AvailableApps"),e.call(this,a("string"==typeof t?t:t.toUrl()),n)||this}return r(t,e),t.prototype.getAppById=function(e){return new ft(this,"getById('"+e+"')")},t.prototype.add=function(e,n,r){void 0===r&&(r=!0);var o=this.toUrl().indexOf("tenantappcatalog")>0?"tenantappcatalog":"sitecollectionappcatalog";return new t(a(this.toUrl()),"_api/web/"+o+"/add(overwrite="+r+",url='"+e+"')").postCore({body:n}).then(function(e){return{data:e,file:new ot(u(e))}})},t}(j),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.deploy=function(e){return void 0===e&&(e=!1),this.clone(t,"Deploy("+e+")").postCore()},t.prototype.retract=function(){return this.clone(t,"Retract").postCore()},t.prototype.install=function(){return this.clone(t,"Install").postCore()},t.prototype.uninstall=function(){return this.clone(t,"Uninstall").postCore()},t.prototype.upgrade=function(){return this.clone(t,"Upgrade").postCore()},t.prototype.remove=function(){return this.clone(t,"Remove").postCore()},t}(k),ht=function(e){function t(t){var n=e.call(this)||this;return n.baseUrl=t,n}return r(t,e),t.ParseResponse=function(e){return new Promise(function(t,n){for(var r,o,i=[],s="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),u=e.split("\n"),c="batch",l=0;l<u.length;++l){var p=u[l];switch(c){case"batch":if(p.substr(0,s.length)===s)c="batchHeaders";else if(""!==p.trim())throw Error("Invalid response, line "+l);break;case"batchHeaders":""===p.trim()&&(c="status");break;case"status":var f=a.exec(p);if(3!==f.length)throw Error("Invalid status, line "+l);r=parseInt(f[1],10),o=f[2],c="statusHeaders";break;case"statusHeaders":""===p.trim()&&(c="body");break;case"body":i.push(204===r?new Response:new Response(p,{status:r,statusText:o})),c="batch"}}"status"!==c&&n(Error("Unexpected end of input")),t(i)})},t.prototype.executeImpl=function(){var e=this;if(_.a.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return _.a.write("Resolving empty batch.",1),Promise.resolve();var r=new R;return f(this.baseUrl).then(function(o){for(var i=[],s="",a=0;a<e.requests.length;a++){var u=e.requests[a];"GET"===u.method?(s.length>0&&(i.push("--changeset_"+s+"--\n\n"),s=""),i.push("--batch_"+e.batchId+"\n")):(s.length<1&&(s=n.i(b.k)(),i.push("--batch_"+e.batchId+"\n"),i.push('Content-Type: multipart/mixed; boundary="changeset_'+s+'"\n\n')),i.push("--changeset_"+s+"\n")),i.push("Content-Type: application/http\n"),i.push("Content-Transfer-Encoding: binary\n\n");var c=new Headers,l=n.i(b.i)(u.url)?u.url:n.i(b.c)(o,u.url);if(_.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Adding request "+u.method+" "+l+" to batch.",0),"GET"!==u.method){var p=u.method,f=u.options.headers;n.i(b.b)(u,"options")&&n.i(b.b)(u.options,"headers")&&void 0!==f["X-HTTP-Method"]&&(p=f["X-HTTP-Method"],delete f["X-HTTP-Method"]),i.push(p+" "+l+" HTTP/1.1\n"),c.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else i.push(u.method+" "+l+" HTTP/1.1\n");n.i(b.g)(c,I.headers),u.options&&n.i(b.g)(c,u.options.headers),c.has("Accept")||c.append("Accept","application/json"),c.has("Content-Type")||c.append("Content-Type","application/json;odata=verbose;charset=utf-8"),c.has("X-ClientService-ClientTag")||c.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.3.3"),c.forEach(function(e,t){i.push(t+": "+e+"\n")}),i.push("\n"),u.options.body&&i.push(u.options.body+"\n\n")}s.length>0&&(i.push("--changeset_"+s+"--\n\n"),s=""),i.push("--batch_"+e.batchId+"--\n");var h={body:i.join(""),headers:{"Content-Type":"multipart/mixed; boundary=batch_"+e.batchId},method:"POST"};return _.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),r.fetch(n.i(b.c)(o,"/_api/$batch"),h).then(function(e){return e.text()}).then(t.ParseResponse).then(function(t){if(t.length!==e.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return _.a.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.reduce(function(t,n,r){var o=e.requests[r];return _.a.write("["+o.id+"] ("+(new Date).getTime()+") Resolving request in batch "+e.batchId+".",1),t.then(function(e){return o.parser.parse(n).then(o.resolve).catch(o.reject)})},Promise.resolve())})})},t}(S.h),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.add=function(e,t){var r=this;return void 0===t&&(t=!1),this.clone(i,"add").postCore({body:n.i(b.l)({featdefScope:0,featureId:e,force:t})}).then(function(t){return{data:t,feature:r.getById(e)}})},t.prototype.getById=function(e){var t=new yt(this);return t.concat("('"+e+"')"),t},t.prototype.remove=function(e,t){return void 0===t&&(t=!1),this.clone(i,"remove").postCore({body:n.i(b.l)({featureId:e,force:t})})};var i;return t=i=o([d("features")],t)}(j),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.deactivate=function(e){var n=this;void 0===e&&(e=!1);var r=this.addBatchDependency();return new t(this).select("DefinitionId").get().then(function(t){var o=n.getParent(dt,n.parentUrl,"",n.batch).remove(t.DefinitionId,e);return r(),o})},t}(k),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),a=t,Object.defineProperty(t.prototype,"rootWeb",{get:function(){return new Et(this,"rootweb")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),t.prototype.getRootWeb=function(){return this.rootWeb.select("Url").get().then(function(e){return new Et(e.Url)})},t.prototype.getContextInfo=function(){return new a(this.parentUrl,"_api/contextinfo").postCore().then(function(e){if(n.i(b.b)(e,"GetContextWebInformation")){var t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})},t.prototype.getDocumentLibraries=function(e){var t=new U("","_api/sp.web.getdocumentlibraries(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return n.i(b.b)(e,"GetDocumentLibraries")?e.GetDocumentLibraries:e})},t.prototype.getWebUrlFromPageUrl=function(e){var t=new U("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(function(e){return n.i(b.b)(e,"GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e})},t.prototype.createBatch=function(){return new ht(this.parentUrl)},t.prototype.openWebById=function(e){return this.clone(a,"openWebById('"+e+"')").postCore().then(function(e){return{data:e,web:Et.fromUrl(e["odata.id"]||e.__metadata.uri)}})},t.prototype.joinHubSite=function(e){return this.clone(a,"joinHubSite('"+e+"')").postCore()},t.prototype.registerHubSite=function(){return this.clone(a,"registerHubSite").postCore()},t.prototype.unRegisterHubSite=function(){return this.clone(a,"unRegisterHubSite").postCore()},t.prototype.createCommunicationSite=function(e,t,r,o,a,u,c,l){var p=this;void 0===t&&(t=1033),void 0===r&&(r=!1),void 0===a&&(a=""),void 0===u&&(u=""),void 0===c&&(c="00000000-0000-0000-0000-000000000000"),void 0===l&&(l="00000000-0000-0000-0000-000000000000");var f={Classification:u,Description:a,HubSiteId:l,Lcid:t,ShareByEmailEnabled:r,SiteDesignId:c,Title:e,Url:o,WebTemplate:"SITEPAGEPUBLISHING#0",WebTemplateExtensionId:"00000000-0000-0000-0000-000000000000"},h=n.i(b.l)({request:n.i(b.d)({__metadata:{type:"Microsoft.SharePoint.Portal.SPSiteCreationRequest"}},f)});return this.getRootWeb().then(function(e){return i(p,void 0,void 0,function(){var t,n;return s(this,function(r){return t=new R,n=e.parentUrl+"/_api/SPSiteManager/Create",[2,t.post(n,{body:h,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})},t.prototype.createModernTeamSite=function(e,t,r,o,a,u,c,l){var p=this;void 0===r&&(r=!0),void 0===o&&(o=1033),void 0===a&&(a=""),void 0===u&&(u=""),void 0===l&&(l="00000000-0000-0000-0000-000000000000");var f=n.i(b.l)({alias:t,displayName:e,isPublic:r,optionalParams:{Classification:u,CreationOptions:{results:["SPSiteLanguage:"+o,"HubSiteId:"+l]},Description:a,Owners:{results:c||[]}}});return this.getRootWeb().then(function(e){return i(p,void 0,void 0,function(){var t,n;return s(this,function(r){return t=new R,n=e.parentUrl+"/_api/GroupSiteManager/CreateGroupEx",[2,t.post(n,{body:f,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"}}).then(function(e){return e.json()})]})})})};var a;return t=a=o([d("_api/site")],t)}(k),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){var t=new vt(this);return t.concat("("+e+")"),t},t.prototype.add=function(e,r,o){var i=this;void 0===o&&(o=!0);var s=n.i(b.l)(n.i(b.d)(h("SP.NavigationNode"),{IsVisible:o,Title:e,Url:r}));return this.clone(t,null).postCore({body:s}).then(function(e){return{data:e,node:i.getById(e.Id)}})},t.prototype.moveAfter=function(e,r){var o=n.i(b.l)({nodeId:e,previousNodeId:r});return this.clone(t,"MoveAfter").postCore({body:o})},t}(j),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return new mt(this,"Children")},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.update=function(e){var t=this,r=n.i(b.l)(n.i(b.d)({__metadata:{type:"SP.NavigationNode"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,node:t}})},t}(k),bt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"quicklaunch",{get:function(){return new mt(this,"quicklaunch")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topNavigationBar",{get:function(){return new mt(this,"topnavigationbar")},enumerable:!0,configurable:!0}),t=o([d("navigation")],t)}(U),_t=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return r(t,e),t.prototype.getMenuState=function(e,r,o,i){return void 0===e&&(e=null),void 0===r&&(r=10),void 0===o&&(o=null),void 0===i&&(i=null),new t(this,"_api/navigation/MenuState").postCore({body:n.i(b.l)({customProperties:i,depth:r,mapProviderName:o,menuNodeKey:e})})},t.prototype.getMenuNodeKey=function(e,r){return void 0===r&&(r=null),new t(this,"_api/navigation/MenuNodeKey").postCore({body:n.i(b.l)({currentUrl:e,mapProviderName:r})})},t}(U),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.FromUrl=function(e){if(null===e)return new i("");var t=e.indexOf("_api/");return new i(t>-1?e.substr(0,t):e)},t.prototype.getRelatedItems=function(e,t){var r=this.clone(i,null);return r.concat(".GetRelatedItems"),r.postCore({body:n.i(b.l)({SourceItemID:t,SourceListName:e})})},t.prototype.getPageOneRelatedItems=function(e,t){var r=this.clone(i,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:n.i(b.l)({SourceItemID:t,SourceListName:e})})},t.prototype.addSingleLink=function(e,t,r,o,s,a,u){void 0===u&&(u=!1);var c=this.clone(i,null);return c.concat(".AddSingleLink"),c.postCore({body:n.i(b.l)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:s,TargetListName:o,TargetWebUrl:a,TryAddReverseLink:u})})},t.prototype.addSingleLinkToUrl=function(e,t,r,o){void 0===o&&(o=!1);var s=this.clone(i,null);return s.concat(".AddSingleLinkToUrl"),s.postCore({body:n.i(b.l)({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:o})})},t.prototype.addSingleLinkFromUrl=function(e,t,r,o){void 0===o&&(o=!1);var s=this.clone(i,null);return s.concat(".AddSingleLinkFromUrl"),s.postCore({body:n.i(b.l)({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:o})})},t.prototype.deleteSingleLink=function(e,t,r,o,s,a,u){void 0===u&&(u=!1);var c=this.clone(i,null);return c.concat(".DeleteSingleLink"),c.postCore({body:n.i(b.l)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:s,TargetListName:o,TargetWebUrl:a,TryDeleteReverseLink:u})})};var i;return t=i=o([d("_api/SP.RelatedItemManager")],t)}(U),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"installedLanguages",{get:function(){return new wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalInstalledLanguages",{get:function(){return new wt(this,"globalinstalledlanguages")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZone",{get:function(){return new Pt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeZones",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),t=o([d("regionalsettings")],t)}(k),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t=o([d("installedlanguages")],t)}(j),Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.utcToLocalTime=function(e){var t;return t="string"==typeof e?e:e.toISOString(),this.clone(i,"utctolocaltime('"+t+"')").postCore().then(function(e){return n.i(b.b)(e,"UTCToLocalTime")?e.UTCToLocalTime:e})},t.prototype.localTimeToUTC=function(e){var t;return t="string"==typeof e?e:n.i(b.m)(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(i,"localtimetoutc('"+t+"')").postCore().then(function(e){return n.i(b.b)(e,"LocalTimeToUTC")?e.LocalTimeToUTC:e})};var i;return t=i=o([d("timezone")],t)}(k),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),n=t,t.prototype.getById=function(e){return this.clone(n,"GetById("+e+")").postCore({},c(Pt))};var n;return t=n=o([d("timezones")],t)}(j),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.add=function(e,t,r,o,s,a){void 0===r&&(r=""),void 0===o&&(o="STS"),void 0===s&&(s=1033),void 0===a&&(a=!0);var c={Description:r,Language:s,Title:e,Url:t,UseSamePermissionsAsParentSite:a,WebTemplate:o},l=n.i(b.l)({parameters:n.i(b.d)({__metadata:{type:"SP.WebCreationInformation"}},c)});return this.clone(i,"add").postCore({body:l}).then(function(e){return{data:e,web:new Et(u(e).replace(/_api\/web\/?/i,""))}})};var i;return t=i=o([d("webs")],t)}(j),It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t=o([d("webinfos")],t)}(j),Et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),c=t,t.fromUrl=function(e,t){return new c(a(e),t)},Object.defineProperty(t.prototype,"webs",{get:function(){return new Ot(this)},enumerable:!0,configurable:!0}),t.prototype.getParentWeb=function(){var e=this;return this.select("ParentWeb/Id").expand("ParentWeb").get().then(function(t){var n=t.ParentWeb;return n?new gt(e.parentUrl).openWebById(n.Id):null})},t.prototype.getSubwebsFilteredForCurrentUser=function(e,t){return void 0===e&&(e=-1),void 0===t&&(t=-1),this.clone(Ot,"getSubwebsFilteredForCurrentUser(nWebTemplateFilter="+e+",nConfigurationFilter="+t+")")},Object.defineProperty(t.prototype,"allProperties",{get:function(){return this.clone(k,"allproperties")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"webinfos",{get:function(){return new It(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentTypes",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lists",{get:function(){return new Ke(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fields",{get:function(){return new Le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"features",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availablefields",{get:function(){return new Le(this,"availablefields")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"navigation",{get:function(){return new bt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUsers",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteGroups",{get:function(){return new q(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteUserInfoList",{get:function(){return new Ve(this,"siteuserinfolist")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regionalSettings",{get:function(){return new Tt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentUser",{get:function(){return new B(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folders",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userCustomActions",{get:function(){return new We(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleDefinitions",{get:function(){return new K(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relatedItems",{get:function(){return St.FromUrl(this.toUrl())},enumerable:!0,configurable:!0}),t.prototype.createBatch=function(){return new ht(this.parentUrl)},Object.defineProperty(t.prototype,"rootFolder",{get:function(){return new Ie(this,"rootFolder")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedOwnerGroup",{get:function(){return new G(this,"associatedownergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedMemberGroup",{get:function(){return new G(this,"associatedmembergroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedVisitorGroup",{get:function(){return new G(this,"associatedvisitorgroup")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultDocumentLibrary",{get:function(){return new Ve(this,"DefaultDocumentLibrary")},enumerable:!0,configurable:!0}),t.prototype.getFolderById=function(e){return new Ie(this,"getFolderById('"+e+"')")},t.prototype.getFolderByServerRelativeUrl=function(e){return new Ie(this,"getFolderByServerRelativeUrl('"+e+"')")},t.prototype.getFolderByServerRelativePath=function(e){return new Ie(this,"getFolderByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getFileById=function(e){return new ot(this,"getFileById('"+e+"')")},t.prototype.getFileByServerRelativeUrl=function(e){return new ot(this,"getFileByServerRelativeUrl('"+e+"')")},t.prototype.getFileByServerRelativePath=function(e){return new ot(this,"getFileByServerRelativePath(decodedUrl='"+e+"')")},t.prototype.getList=function(e){return new Ve(this,"getList('"+e+"')")},t.prototype.update=function(e){var t=this,r=n.i(b.l)(n.i(b.d)({__metadata:{type:"SP.Web"}},e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(function(e){return{data:e,web:t}})},t.prototype.delete=function(){return e.prototype.deleteCore.call(this)},t.prototype.applyTheme=function(e,t,r,o){var i=n.i(b.l)({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:o});return this.clone(c,"applytheme").postCore({body:i})},t.prototype.applyWebTemplate=function(e){var t=this.clone(c,"applywebtemplate");return t.concat("(@t)"),t.query.set("@t",e),t.postCore()},t.prototype.ensureUser=function(e){var t=n.i(b.l)({logonName:e});return this.clone(c,"ensureuser").postCore({body:t}).then(function(e){return{data:e,user:new F(u(e))}})},t.prototype.availableWebTemplates=function(e,t){return void 0===e&&(e=1033),void 0===t&&(t=!0),new j(this,"getavailablewebtemplates(lcid="+e+", doincludecrosslanguage="+t+")")},t.prototype.getCatalog=function(e){return this.clone(c,"getcatalog("+e+")").select("Id").get().then(function(e){return new Ve(u(e))})},t.prototype.getChanges=function(e){var t=n.i(b.l)({query:n.i(b.d)({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(c,"getchanges").postCore({body:t})},Object.defineProperty(t.prototype,"customListTemplate",{get:function(){return new j(this,"getcustomlisttemplates")},enumerable:!0,configurable:!0}),t.prototype.getUserById=function(e){return new F(this,"getUserById("+e+")")},t.prototype.mapToIcon=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=""),this.clone(c,"maptoicon(filename='"+e+"', progid='"+n+"', size="+t+")").get()},t.prototype.getStorageEntity=function(e){return this.clone(c,"getStorageEntity('"+e+"')").get()},t.prototype.setStorageEntity=function(e,t,r,o){return void 0===r&&(r=""),void 0===o&&(o=""),this.clone(c,"setStorageEntity").postCore({body:n.i(b.l)({comments:o,description:r,key:e,value:t})})},t.prototype.removeStorageEntity=function(e){return this.clone(c,"removeStorageEntity('"+e+"')").postCore()},t.prototype.getAppCatalog=function(e){return new pt(e||this)},t.prototype.getSiteCollectionAppCatalog=function(e){return new pt(e||this,"_api/web/sitecollectionappcatalog/AvailableApps")},t.prototype.getClientSideWebParts=function(){return this.clone(j,"GetClientSideWebParts").get()},t.prototype.addClientSidePage=function(e,t){return void 0===t&&(t=e.replace(/\.[^\/.]+$/,"")),xt.create(this,e,t)},t.prototype.addClientSidePageByPath=function(e,t){return void 0===t&&(t=e.replace(/\.[^\/.]+$/,"")),xt.create(this,e,t)},t.prototype.createDefaultAssociatedGroups=function(e,t,n){var r=this.clone(c,"createDefaultAssociatedGroups(userLogin=@u,userLogin2=@v,groupNameSeed=@s)");return r.query.set("@u","'"+encodeURIComponent(e||"")+"'"),r.query.set("@v","'"+encodeURIComponent(t||"")+"'"),r.query.set("@s","'"+encodeURIComponent(n||"")+"'"),r.postCore()},t.prototype.hubSiteData=function(e){return void 0===e&&(e=!1),i(this,void 0,void 0,function(){return s(this,function(t){return[2,this.clone(c,"hubSiteData("+e+")").get().then(function(e){return JSON.parse(e)})]})})},t.prototype.syncHubSiteTheme=function(){return this.clone(c,"syncHubSiteTheme").postCore()};var c;return t=c=o([d("_api/web")],t)}(me);!function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(lt||(lt={}));var Nt,xt=function(e){function t(r,o,i,s,u,c){void 0===s&&(s=!1),void 0===u&&(u=[]),void 0===c&&(c=!1);var l=e.call(this,r,o)||this;return l.json=i,l.sections=u,l.commentsDisabled=c,l._bannerImageDirty=!1,"string"==typeof r?(l._parentUrl="",l._url=n.i(b.c)(a(r),o)):l.extend(t.initFrom(r,null),o),l._pageSettings={controlType:0,pageSettingsSlice:{isDefaultDescription:!0,isDefaultThumbnail:!0}},l._layoutPart=t.getDefaultLayoutPart(),void 0===i||s||l.fromJSON(i),l}return r(t,e),t.create=function(e,r,o,a){return void 0===a&&(a="Article"),i(this,void 0,void 0,function(){var i,u;return s(this,function(s){switch(s.label){case 0:return r=r.replace(/\.aspx$/i,""),[4,t.initFrom(e,"_api/sitepages/pages").postCore({body:n.i(b.l)(Object.assign(h("SP.Publishing.SitePage"),{PageLayoutType:a}))})];case 1:return i=s.sent(),u=new t(e,"",i),u.title=r,[4,u.save(!1)];case 2:return s.sent(),u.title=o,[2,u]}})})},t.fromFile=function(e){return e.getItem().then(function(n){return new t(a(e.toUrl()),"",{Id:n.Id},!0).configureFrom(e).load()})},t.getDefaultLayoutPart=function(){return{dataVersion:"1.4",description:"Title Region Description",id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",properties:{authors:[],layoutType:"FullWidthImage",showPublishDate:!1,showTopicHeader:!1,textAlignment:"Left",title:"",topicHeader:""},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},title:"Title area"}},t.initFrom=function(e,n){return new t(a(e.toUrl()),n).configureFrom(e)},Object.defineProperty(t.prototype,"pageLayout",{get:function(){return this.json.PageLayoutType},set:function(e){this.json.PageLayoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bannerImageUrl",{get:function(){return this.json.BannerImageUrl},set:function(e){this.json.BannerImageUrl=e,this._bannerImageDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bannerImageSourceType",{get:function(){return this._layoutPart.properties.imageSourceType},set:function(e){this._layoutPart.properties.imageSourceType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topicHeader",{get:function(){return n.i(b.n)(this.json.TopicHeader)?this.json.TopicHeader:""},set:function(e){this.json.TopicHeader=e,this._layoutPart.properties.topicHeader=e,n.i(b.a)(e)&&(this.showTopicHeader=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._layoutPart.properties.title},set:function(e){this.json.Title=e,this._layoutPart.properties.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layoutType",{get:function(){return this._layoutPart.properties.layoutType},set:function(e){this._layoutPart.properties.layoutType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headerTextAlignment",{get:function(){return this._layoutPart.properties.textAlignment},set:function(e){this._layoutPart.properties.textAlignment=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showTopicHeader",{get:function(){return this._layoutPart.properties.showTopicHeader},set:function(e){this._layoutPart.properties.showTopicHeader=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showPublishDate",{get:function(){return this._layoutPart.properties.showPublishDate},set:function(e){this._layoutPart.properties.showPublishDate=e},enumerable:!0,configurable:!0}),t.prototype.addSection=function(){var e=new Rt(this,y(this.sections));return this.sections.push(e),e},t.prototype.fromJSON=function(e){this.json=e;var t=JSON.parse(e.CanvasContent1),n=JSON.parse(e.LayoutWebpartsContent);return n&&n.length>0&&(this._layoutPart=n[0]),this.setControls(t),this},t.prototype.load=function(){var e=this;return this.getItem("Id","CommentsDisabled").then(function(t){return new U(e,"_api/sitepages/pages("+t.Id+")").get().then(function(n){return e.commentsDisabled=t.CommentsDisabled,e.fromJSON(n)})})},t.prototype.save=function(e){var r=this;if(void 0===e&&(e=!0),null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");var o=Promise.resolve({});return this._bannerImageDirty&&(o=o.then(function(e){return new Promise(function(e,t){var o=r.json.BannerImageUrl;n.i(b.i)(o)&&(o=o.replace(/^https?:\/\/[a-z0-9\.]*?\.[a-z]{2,3}\//i,"/"));var i=new gt(a(r.toUrl())),s=new Et(a(r.toUrl())),u=s.getFileByServerRelativePath(o),c="",l="",p="",f="",h="";Promise.all([i.select("Id","Url").get().then(function(e){return c=e.Id}),s.select("Id","Url").get().then(function(e){l=e.Id,h=e.Url}),u.listItemAllFields.select("UniqueId","ParentList/Id").expand("ParentList").get().then(function(e){p=e.UniqueId,f=e.ParentList.Id})]).then(function(){var t=new U(h,"_layouts/15/getpreview.ashx");t.query.set("guidSite",""+c),t.query.set("guidWeb",""+l),t.query.set("guidFile",""+p),r.bannerImageUrl=t.toUrlAndQuery(),n.i(b.n)(r._layoutPart.serverProcessedContent)||(r._layoutPart.serverProcessedContent={}),r._layoutPart.serverProcessedContent.imageSources={imageSource:o},n.i(b.n)(r._layoutPart.serverProcessedContent.customMetadata)||(r._layoutPart.serverProcessedContent.customMetadata={}),r._layoutPart.serverProcessedContent.customMetadata.imageSource={listId:f,siteId:c,uniqueId:p,webId:l},r._layoutPart.properties.webId=l,r._layoutPart.properties.siteId=c,r._layoutPart.properties.listId=f,r._layoutPart.properties.uniqueId=p,e()}).catch(t)})})),this.json.IsPageCheckedOutToCurrentUser||(o=o.then(function(e){return t.initFrom(r,"_api/sitepages/pages("+r.json.Id+")/checkoutpage").postCore()})),o=o.then(function(e){var o=Object.assign(h("SP.Publishing.SitePage"),{AuthorByline:r.json.AuthorByline||[],BannerImageUrl:r.bannerImageUrl,CanvasContent1:r.getCanvasContent1(),LayoutWebpartsContent:r.getLayoutWebpartsContent(),Title:r.title,TopicHeader:r.topicHeader}),i=t.initFrom(r,"_api/sitepages/pages("+r.json.Id+")/savepage");return i.configure({headers:{"if-match":"*"}}),i.postCore({body:n.i(b.l)(o)})}),e&&(o=o.then(function(e){return t.initFrom(r,"_api/sitepages/pages("+r.json.Id+")/publish").postCore()}).then(function(e){e&&(r.json.IsPageCheckedOutToCurrentUser=!1)})),o=o.then(function(e){r._bannerImageDirty=!1})},t.prototype.discardPageCheckout=function(){return i(this,void 0,void 0,function(){var e;return s(this,function(r){switch(r.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,t.initFrom(this,"_api/sitepages/pages("+this.json.Id+")/discardPage").postCore({body:n.i(b.l)(h("SP.Publishing.SitePage"))})];case 1:return e=r.sent(),this.fromJSON(e),[2]}})})},t.prototype.promoteToNews=function(){return i(this,void 0,void 0,function(){return s(this,function(e){return[2,this.promoteNewsImpl("promoteToNews")]})})},t.prototype.enableComments=function(){var e=this;return this.setCommentsOn(!0).then(function(t){return e.commentsDisabled=!1,t})},t.prototype.disableComments=function(){var e=this;return this.setCommentsOn(!1).then(function(t){return e.commentsDisabled=!0,t})},t.prototype.findControlById=function(e){return this.findControl(function(t){return t.id===e})},t.prototype.findControl=function(e){for(var t=0;t<this.sections.length;t++)for(var n=0;n<this.sections[t].columns.length;n++)for(var r=0;r<this.sections[t].columns[n].controls.length;r++)if(e(this.sections[t].columns[n].controls[r]))return this.sections[t].columns[n].controls[r];return null},t.prototype.like=function(){return this.getItem().then(function(e){return e.like()})},t.prototype.unlike=function(){return this.getItem().then(function(e){return e.unlike()})},t.prototype.getLikedByInformation=function(){return this.getItem().then(function(e){return e.getLikedByInformation()})},t.prototype.copyPage=function(e,n,r,o){return void 0===o&&(o=!0),i(this,void 0,void 0,function(){var i;return s(this,function(s){switch(s.label){case 0:return[4,t.create(e,n,r,this.pageLayout)];case 1:return i=s.sent(),i.setControls(this.getControls()),[4,i.save(o)];case 2:return s.sent(),[2,i]}})})},t.prototype.setBannerImage=function(e,t){this.bannerImageUrl=e,this.bannerImageSourceType=2,n.i(b.n)(t)&&(n.i(b.b)(t,"translateX")&&(this._layoutPart.properties.translateX=t.translateX),n.i(b.b)(t,"translateY")&&(this._layoutPart.properties.translateY=t.translateY),n.i(b.b)(t,"imageSourceType")&&(this.bannerImageSourceType=t.imageSourceType),n.i(b.b)(t,"altText")&&(this._layoutPart.properties.altText=t.altText))},t.prototype.getCanvasContent1=function(){return JSON.stringify(this.getControls())},t.prototype.getLayoutWebpartsContent=function(){return this._layoutPart?JSON.stringify([this._layoutPart]):JSON.stringify(null)},t.prototype.setControls=function(e){if(e&&e.length){for(var t=0;t<e.length;t++){switch(n.i(b.b)(e[t],"controlType")?e[t].controlType:0){case 0:n.i(b.b)(e[t],"pageSettingsSlice")?this._pageSettings=e[t]:this.mergeColumnToTree(new At(e[t]));break;case 3:var r=new kt(e[t]);this.mergePartToTree(r,r.data.position);break;case 4:var o=e[t],i=new jt(o.innerHTML,o);this.mergePartToTree(i,i.data.position)}}g(this.sections)}},t.prototype.getControls=function(){var e=this;g(this.sections);var t=[];return this.sections.forEach(function(n){n.columns.forEach(function(r){r.controls.length<1?t.push({displayMode:r.data.displayMode,emphasis:e.getEmphasisObj(n.emphasis),position:r.data.position}):r.controls.forEach(function(r){r.data.emphasis=e.getEmphasisObj(n.emphasis),t.push(r.data)})})}),t.push(this._pageSettings),t},t.prototype.getEmphasisObj=function(e){return e<1||e>3?{}:{zoneEmphasis:e}},t.prototype.setCommentsOn=function(e){return this.getItem().then(function(t){return new Ye(t,"SetCommentsDisabled("+!e+")").update({})})},t.prototype.promoteNewsImpl=function(e){return i(this,void 0,void 0,function(){var r;return s(this,function(o){switch(o.label){case 0:if(null===this.json.Id)throw Error("The id for this page is null. If you want to create a new page, please use ClientSidePage.Create");return[4,t.initFrom(this,"_api/sitepages/pages("+this.json.Id+")/"+e).postCore({body:n.i(b.l)(h("SP.Publishing.SitePage"))})];case 1:return r=o.sent(),[2,r]}})})},t.prototype.mergePartToTree=function(e,t){var r=null,o=null,i=12,s=0,a=0;t&&(n.i(b.b)(t,"zoneIndex")&&(a=t.zoneIndex),n.i(b.b)(t,"sectionIndex")&&(s=t.sectionIndex),n.i(b.b)(t,"sectionFactor")&&(i=t.sectionFactor));var u=this.sections.filter(function(e){return e.order===a});u.length<1?(r=new Rt(this,a),this.sections.push(r)):r=u[0],r.emphasis=e.data.emphasis.zoneEmphasis||0;var c=r.columns.filter(function(e){return e.order===s});o=c.length<1?r.addColumn(i):c[0],e.column=o,o.addControl(e)},t.prototype.mergeColumnToTree=function(e){var t=n.i(b.b)(e.data,"position")&&n.i(b.b)(e.data.position,"zoneIndex")?e.data.position.zoneIndex:0,r=null,o=this.sections.filter(function(e){return e.order===t});o.length<1?(r=new Rt(this,t),r.emphasis=e.data.emphasis.zoneEmphasis||0,this.sections.push(r)):r=o[0],e.section=r,r.columns.push(e)},t.prototype.getItem=function(){for(var e=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t.initFrom(this,"/_api/lists/EnsureClientRenderedSitePagesLibrary").select("EnableModeration","EnableMinorVersions","Id").postCore().then(function(t){var o=new Ve(t["odata.id"]).configureFrom(e).items.getById(e.json.Id);return o.select.apply(o,r).get().then(function(t){return n.i(b.d)(new Ye(u(t)).configureFrom(e),t)})})},t}(U),Rt=function(){function e(e,t,r,o){void 0===r&&(r=[]),void 0===o&&(o=0),this.page=e,this.columns=r,this._emphasis=o,this._memId=n.i(b.k)(),this._order=t}return Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(e){this._order=e;for(var t=0;t<this.columns.length;t++)this.columns[t].data.position.zoneIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultColumn",{get:function(){return this.columns.length<1&&this.addColumn(12),this.columns[0]},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=new At;return t.section=this,t.data.position.zoneIndex=this.order,t.data.position.sectionFactor=e,t.order=y(this.columns),this.columns.push(t),t},e.prototype.addControl=function(e){return this.defaultColumn.addControl(e),this},Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._emphasis},set:function(e){this._emphasis=e},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var e=this;this.page.sections=this.page.sections.filter(function(t){return t._memId!==e._memId}),g(this.page.sections)},e}(),At=function(){function e(t,r){void 0===t&&(t=JSON.parse(JSON.stringify(e.Default))),void 0===r&&(r=[]),this.json=t,this.controls=r,this._section=null,this._memId=n.i(b.k)()}return Object.defineProperty(e.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"section",{get:function(){return this._section},set:function(e){this._section=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this.data.position.sectionIndex},set:function(e){this.data.position.sectionIndex=e;for(var t=0;t<this.controls.length;t++)this.controls[t].data.position.zoneIndex=this.data.position.zoneIndex,this.controls[t].data.position.sectionIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"factor",{get:function(){return this.data.position.sectionFactor},set:function(e){this.data.position.sectionFactor=e},enumerable:!0,configurable:!0}),e.prototype.addControl=function(e){return e.column=this,this.controls.push(e),this},e.prototype.getControl=function(e){return this.controls[e]},e.prototype.remove=function(){var e=this;this.section.columns=this.section.columns.filter(function(t){return t._memId!==e._memId}),g(this.section.columns)},e.Default={controlType:0,displayMode:2,emphasis:{},position:{layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},e}(),Ut=function(){function e(e){this.json=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this.json.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.json},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},set:function(e){this._column=e,this.onColumnChange(this._column)},enumerable:!0,configurable:!0}),e.prototype.remove=function(){var e=this;this.column.controls=this.column.controls.filter(function(t){return t.id!==e.id}),g(this.column.controls)},e.prototype.setData=function(e){this.json=e},e}(),jt=function(e){function t(r,o){void 0===o&&(o=JSON.parse(JSON.stringify(t.Default)));var i=this;return n.i(b.a)(o.id)&&(o.id=n.i(b.k)(),o.anchorComponentId=o.id),i=e.call(this,o)||this,i.text=r,i}return r(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.data.innerHTML},set:function(e){e.startsWith("<p>")||(e="<p>"+e+"</p>"),this.data.innerHTML=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),t.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=y(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.order},t.Default={addedFromPersistedData:!1,anchorComponentId:"",controlType:4,displayMode:2,editorType:"CKEditor",emphasis:{},id:"",innerHTML:"",position:{controlIndex:1,layoutIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1}},t}(Ut),kt=function(e){function t(n){return void 0===n&&(n=JSON.parse(JSON.stringify(t.Default))),e.call(this,n)||this}return r(t,e),t.fromComponentDef=function(e){var n=new t;return n.import(e),n},Object.defineProperty(t.prototype,"title",{get:function(){return this.data.webPartData.title},set:function(e){this.data.webPartData.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this.data.webPartData.description},set:function(e){this.data.webPartData.description=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.data.position.controlIndex},set:function(e){this.data.position.controlIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.data.reservedHeight},set:function(e){this.data.reservedHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.data.reservedWidth},set:function(e){this.data.reservedWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return this.data.webPartData.dataVersion},set:function(e){this.data.webPartData.dataVersion=e},enumerable:!0,configurable:!0}),t.prototype.setProperties=function(e){return this.data.webPartData.properties=n.i(b.d)(this.data.webPartData.properties,e),this},t.prototype.getProperties=function(){return this.data.webPartData.properties},t.prototype.onColumnChange=function(e){this.data.position.sectionFactor=e.factor,this.data.position.controlIndex=y(e.controls),this.data.position.zoneIndex=e.data.position.zoneIndex,this.data.position.sectionIndex=e.data.position.sectionIndex},t.prototype.import=function(e){var t=n.i(b.k)(),r=e.Id.replace(/^\{|\}$/g,"").toLowerCase(),o=JSON.parse(e.Manifest),i=o.preconfiguredEntries[0];this.setData(Object.assign({},this.data,{id:t,webPartData:{dataVersion:"1.0",description:i.description.default,id:r,instanceId:t,properties:i.properties,title:i.title.default},webPartId:r}))},t.Default={addedFromPersistedData:!1,controlType:3,displayMode:2,emphasis:{},id:null,position:{controlIndex:1,sectionFactor:12,sectionIndex:1,zoneIndex:1},reservedHeight:500,reservedWidth:500,webPartData:null,webPartId:null},t}(Ut),Dt=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),Lt=new Map([]),Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.execute=function(e){var t=this,r=this.parseQuery(e),o=n.i(b.l)({request:n.i(b.d)(h("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},r,{HitHighlightedProperties:this.fixArrProp(r.HitHighlightedProperties),Properties:this.fixArrProp(r.Properties),RefinementFilters:this.fixArrProp(r.RefinementFilters),ReorderingRules:this.fixArrProp(r.ReorderingRules),SelectProperties:this.fixArrProp(r.SelectProperties),SortList:this.fixArrProp(r.SortList)}))});if(this._useCaching){this._forceCaching=!0;var i="PnPjs.SearchWithCaching("+n.i(b.o)(o)+")";n.i(b.n)(this._cachingOptions)?/\/_api\/search\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=i):this._cachingOptions=new S.i(i)}return this.postCore({body:o}).then(function(e){return new Bt(e,t.toUrl(),r)})},t.prototype.fixArrProp=function(e){return void 0===e?{results:[]}:(e=n.i(b.p)(e)?e:[e],n.i(b.b)(e,"results")?e:{results:e})},t.prototype.parseQuery=function(e){return"string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e},t=o([d("_api/search/postquery")],t)}(k),Bt=function(){function e(e,t,n,r,o){void 0===r&&(r=null),void 0===o&&(o=null),this._url=t,this._query=n,this._raw=r,this._primary=o,this._raw=e.postquery?e.postquery:e}return Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){return this.RawSearchResults.ElapsedTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RowCount",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRows",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TotalRowsIncludingDuplicates",{get:function(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RawSearchResults",{get:function(){return this._raw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PrimarySearchResults",{get:function(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary},enumerable:!0,configurable:!0}),e.prototype.getPage=function(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);var r=void 0!==t?t:n.i(b.b)(this._query,"RowLimit")?this._query.RowLimit:10,o=n.i(b.d)(this._query,{RowLimit:r,StartRow:r*(e-1)});return o.StartRow>this.TotalRows?Promise.resolve(null):new Ft(this._url,null).execute(o)},e.prototype.formatSearchResults=function(e){for(var t=new Array,n=e.results?e.results:e,r=0,o=n;r<o.length;r++){var i=o[r],s=i.Cells.results?i.Cells.results:i.Cells;t.push(s.reduce(function(e,t){return Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e},{}))}return t},e}();!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(Nt||(Nt={}));var Mt;!function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(Mt||(Mt={}));var qt;!function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(qt||(qt={}));var Gt,Wt=function(){function e(){}return e.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",e.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",e.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",e.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",e.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",e.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",e.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",e.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",e.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",e.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",e.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",e.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",e.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",e.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",e.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1",e}(),Ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.execute=function(e){return this.mapQueryToQueryString(e),this.get().then(function(e){var t=n.i(b.b)(e,"suggest")?function(t){return e.suggest[t].results}:function(t){return e[t]};return{PeopleNames:t("PeopleNames"),PersonalResults:t("PersonalResults"),Queries:t("Queries")}})},t.prototype.mapQueryToQueryString=function(e){var t=this,r=function(e){return function(r){return function(o){n.i(b.b)(e,r)&&t.query.set(o,e[r].toString())}}};this.query.set("querytext","'"+e.querytext+"'");var o=r(e);o("count")("inumberofquerysuggestions"),o("personalCount")("inumberofresultsuggestions"),o("preQuery")("fprequerysuggestions"),o("hitHighlighting")("fhithighlighting"),o("capitalize")("fcapitalizefirstletters"),o("culture")("culture"),o("stemming")("enablestemming"),o("includePeople")("showpeoplenamesuggestions"),o("queryRules")("enablequeryrules"),o("prefixMatch")("fprefixmatchallterms")},t=o([d("_api/search/suggest")],t)}(k),Kt=function(e){function t(t,n){void 0===n&&(n="_api/sp.userprofiles.peoplemanager");var r=e.call(this,t,n)||this;return r.clientPeoplePickerQuery=new zt(t).configureFrom(r),r.profileLoader=new Vt(t).configureFrom(r),r}return r(t,e),Object.defineProperty(t.prototype,"editProfileLink",{get:function(){return this.clone(t,"EditProfileLink").get()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMyPeopleListPublic",{get:function(){return this.clone(t,"IsMyPeopleListPublic").get()},enumerable:!0,configurable:!0}),t.prototype.amIFollowedBy=function(e){var n=this.clone(t,"amifollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.amIFollowing=function(e){var n=this.clone(t,"amifollowing(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getFollowedTags=function(e){return void 0===e&&(e=20),this.clone(t,"getfollowedtags("+e+")").get()},t.prototype.getFollowersFor=function(e){var n=this.clone(t,"getfollowersfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"myFollowers",{get:function(){return new j(this,"getmyfollowers")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"myProperties",{get:function(){return new t(this,"getmyproperties")},enumerable:!0,configurable:!0}),t.prototype.getPeopleFollowedBy=function(e){var n=this.clone(t,"getpeoplefollowedby(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},t.prototype.getPropertiesFor=function(e){var n=this.clone(t,"getpropertiesfor(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.get()},Object.defineProperty(t.prototype,"trendingTags",{get:function(){var e=this.clone(t,null);return e.concat(".gettrendingtags"),e.get()},enumerable:!0,configurable:!0}),t.prototype.getUserProfilePropertyFor=function(e,n){var r=this.clone(t,"getuserprofilepropertyfor(accountname=@v, propertyname='"+n+"')");return r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.get()},t.prototype.hideSuggestion=function(e){var n=this.clone(t,"hidesuggestion(@v)");return n.query.set("@v","'"+encodeURIComponent(e)+"'"),n.postCore()},t.prototype.isFollowing=function(e,n){var r=this.clone(t,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v","'"+encodeURIComponent(e)+"'"),r.query.set("@y","'"+encodeURIComponent(n)+"'"),r.get()},t.prototype.setMyProfilePic=function(e){var n=this;return new Promise(function(r,o){var i=null,s=new FileReader;s.onload=function(e){return i=e.target.result},s.readAsArrayBuffer(e),new t(n,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(i))}).then(function(e){return r()}).catch(function(e){return o(e)})})},t.prototype.setSingleValueProfileProperty=function(e,r,o){var i=n.i(b.l)({accountName:e,propertyName:r,propertyValue:o});return this.clone(t,"SetSingleValueProfileProperty").postCore({body:i})},t.prototype.setMultiValuedProfileProperty=function(e,r,o){var i=n.i(b.l)({accountName:e,propertyName:r,propertyValues:o});return this.clone(t,"SetMultiValuedProfileProperty").postCore({body:i})},t.prototype.createPersonalSiteEnqueueBulk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.profileLoader.createPersonalSiteEnqueueBulk(e)},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){return this.profileLoader.ownerUserProfile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.profileLoader.userProfile},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.profileLoader.createPersonalSite(e)},t.prototype.shareAllSocialData=function(e){return this.profileLoader.shareAllSocialData(e)},t.prototype.clientPeoplePickerResolveUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)},t.prototype.clientPeoplePickerSearchUser=function(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)},t}(k),Vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.createPersonalSiteEnqueueBulk=function(e){return this.clone(i,"createpersonalsiteenqueuebulk",!1).postCore({body:n.i(b.l)({emailIDs:e})})},Object.defineProperty(t.prototype,"ownerUserProfile",{get:function(){var e=this.getParent(i,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userProfile",{get:function(){return this.clone(i,"getuserprofile").postCore()},enumerable:!0,configurable:!0}),t.prototype.createPersonalSite=function(e){return void 0===e&&(e=!1),this.clone(i,"getuserprofile/createpersonalsiteenque("+e+")").postCore()},t.prototype.shareAllSocialData=function(e){return this.clone(i,"getuserprofile/shareallsocialdata("+e+")").postCore()};var i;return t=i=o([d("_api/sp.userprofiles.profileloader.getprofileloader")],t)}(U),zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.clientPeoplePickerResolveUser=function(e){var t=this.clone(i,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerResolveUser:e}).then(JSON.parse)},t.prototype.clientPeoplePickerSearchUser=function(e){var t=this.clone(i,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(function(e){return"object"==typeof e?e.ClientPeoplePickerSearchUser:e}).then(JSON.parse)},t.prototype.createClientPeoplePickerQueryParametersRequestBody=function(e){return n.i(b.l)({queryParams:n.i(b.d)(h("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})};var i;return t=i=o([d("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],t)}(U),Qt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,Object.defineProperty(t.prototype,"my",{get:function(){return new Xt(this)},enumerable:!0,configurable:!0}),t.prototype.getFollowedSitesUri=function(){return this.clone(i,"FollowedSitesUri").get().then(function(e){return e.FollowedSitesUri||e})},t.prototype.getFollowedDocumentsUri=function(){return this.clone(i,"FollowedDocumentsUri").get().then(function(e){return e.FollowedDocumentsUri||e})},t.prototype.follow=function(e){return this.clone(i,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.isFollowed=function(e){return this.clone(i,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.stopFollowing=function(e){return this.clone(i,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})},t.prototype.createSocialActorInfoRequestBody=function(e){return n.i(b.l)({actor:Object.assign(h("SP.Social.SocialActorInfo"),{Id:null},e)})};var i;return t=i=o([d("_api/social.following")],t)}(k),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r(t,e),i=t,t.prototype.followed=function(e){return this.clone(i,"followed(types="+e+")").get().then(function(e){return n.i(b.b)(e,"Followed")?e.Followed.results:e})},t.prototype.followedCount=function(e){return this.clone(i,"followedcount(types="+e+")").get().then(function(e){return e.FollowedCount||e})},t.prototype.followers=function(){return this.clone(i,"followers").get().then(function(e){return n.i(b.b)(e,"Followers")?e.Followers.results:e})},t.prototype.suggestions=function(){return this.clone(i,"suggestions").get().then(function(e){return n.i(b.b)(e,"Suggestions")?e.Suggestions.results:e})};var i;return t=i=o([d("my")],t)}(k);!function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Gt||(Gt={}));var Jt;!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Jt||(Jt={}));var Yt;!function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(Yt||(Yt={}));var $t;!function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}($t||($t={}));var Zt=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return r(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,n=t.toUrl(),r=n.indexOf("_api/");return r<0?n:n.substr(0,r)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e)})},t.prototype.getSiteScripts=function(){return this.clone(t,"GetSiteScripts",!0).execute({})},t.prototype.createSiteScript=function(e,n,r){return i(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"CreateSiteScript(Title=@title,Description=@desc)?@title='"+encodeURIComponent(e)+"'&@desc='"+encodeURIComponent(n)+"'").execute(r)];case 1:return[2,o.sent()]}})})},t.prototype.getSiteScriptMetadata=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteScriptMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteScript=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteScript").execute({id:e})];case 1:return n.sent(),[2]}})})},t.prototype.updateSiteScript=function(e,n){return i(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return n&&(e.Content=JSON.stringify(n)),[4,this.clone(t,"UpdateSiteScript").execute({updateInfo:e})];case 1:return[2,r.sent()]}})})},t}(U),en=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/Microsoft.Sharepoint.Utilities.WebTemplateExtensions.SiteScriptUtility."+r)||this}return r(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,n=t.toUrl(),r=n.indexOf("_api/");return r<0?n:n.substr(0,r)},t.prototype.execute=function(e){return this.postCore({body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}})},t.prototype.createSiteDesign=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"CreateSiteDesign").execute({info:e})];case 1:return[2,n.sent()]}})})},t.prototype.applySiteDesign=function(e,n){return i(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"ApplySiteDesign").execute({siteDesignId:e,webUrl:n})];case 1:return[2,r.sent()]}})})},t.prototype.getSiteDesigns=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.clone(t,"GetSiteDesigns").execute({})];case 1:return[2,e.sent()]}})})},t.prototype.getSiteDesignMetadata=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignMetadata").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.updateSiteDesign=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"UpdateSiteDesign").execute({updateInfo:e})];case 1:return[2,n.sent()]}})})},t.prototype.deleteSiteDesign=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"DeleteSiteDesign").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.getSiteDesignRights=function(e){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return[4,this.clone(t,"GetSiteDesignRights").execute({id:e})];case 1:return[2,n.sent()]}})})},t.prototype.grantSiteDesignRights=function(e,n,r){return void 0===r&&(r=1),i(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.clone(t,"GrantSiteDesignRights").execute({grantedRights:r.toString(),id:e,principalNames:n})];case 1:return[2,o.sent()]}})})},t.prototype.revokeSiteDesignRights=function(e,n){return i(this,void 0,void 0,function(){return s(this,function(r){switch(r.label){case 0:return[4,this.clone(t,"RevokeSiteDesignRights").execute({id:e,principalNames:n})];case 1:return[2,r.sent()]}})})},t}(U),tn=function(e){function t(n,r){return e.call(this,t.getBaseUrl(n),"_api/SP.Utilities.Utility."+r)||this}return r(t,e),t.getBaseUrl=function(e){if("string"==typeof e)return e;var t=e,n=t.toUrl(),r=n.indexOf("_api/");return r<0?n:n.substr(0,r)},t.prototype.excute=function(e){return this.postCore({body:n.i(b.l)(e)})},t.prototype.sendEmail=function(e){var r={properties:n.i(b.d)(h("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(r.properties=n.i(b.d)(r.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(r.properties=n.i(b.d)(r.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(r.properties=n.i(b.d)(r.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(r.properties=n.i(b.d)(r.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(t,"SendEmail",!0).excute(r)},t.prototype.getCurrentUserEmailAddresses=function(){return this.clone(t,"GetCurrentUserEmailAddresses",!0).excute({}).then(function(e){return n.i(b.b)(e,"GetCurrentUserEmailAddresses")?e.GetCurrentUserEmailAddresses:e})},t.prototype.resolvePrincipal=function(e,r,o,i,s,a){void 0===a&&(a=!1);var u={addToUserInfoList:s,input:e,inputIsEmailOnly:i,matchUserInfoList:a,scopes:r,sources:o};return this.clone(t,"ResolvePrincipalInCurrentContext",!0).excute(u).then(function(e){return n.i(b.b)(e,"ResolvePrincipalInCurrentContext")?e.ResolvePrincipalInCurrentContext:e})},t.prototype.searchPrincipals=function(e,r,o,i,s){var a={groupName:i,input:e,maxCount:s,scopes:r,sources:o};return this.clone(t,"SearchPrincipalsUsingContextWeb",!0).excute(a).then(function(e){return n.i(b.b)(e,"SearchPrincipalsUsingContextWeb")?e.SearchPrincipalsUsingContextWeb:e})},t.prototype.createEmailBodyForInvitation=function(e){var r={pageAddress:e};return this.clone(t,"CreateEmailBodyForInvitation",!0).excute(r).then(function(e){return n.i(b.b)(e,"CreateEmailBodyForInvitation")?e.CreateEmailBodyForInvitation:e})},t.prototype.expandGroupsToPrincipals=function(e,r){void 0===r&&(r=30);var o={inputs:e,maxCount:r};return this.clone(t,"ExpandGroupsToPrincipals",!0).excute(o).then(function(e){return n.i(b.b)(e,"ExpandGroupsToPrincipals")?e.ExpandGroupsToPrincipals:e})},t.prototype.createWikiPage=function(e){return this.clone(t,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(function(e){return{data:n.i(b.b)(e,"CreateWikiPageInContextWeb")?e.CreateWikiPageInContextWeb:e,file:new ot(u(e))}})},t.prototype.containsInvalidFileFolderChars=function(e,n){return void 0===n&&(n=!1),n?t.InvalidFileFolderNameCharsOnPremiseRegex.test(e):t.InvalidFileFolderNameCharsOnlineRegex.test(e)},t.prototype.stripInvalidFileFolderChars=function(e,n,r){return void 0===n&&(n=""),void 0===r&&(r=!1),r?e.replace(t.InvalidFileFolderNameCharsOnPremiseRegex,n):e.replace(t.InvalidFileFolderNameCharsOnlineRegex,n)},t.InvalidFileFolderNameCharsOnlineRegex=/["*:<>?\/\\|\x00-\x1f\x7f-\x9f]/g,t.InvalidFileFolderNameCharsOnPremiseRegex=/["#%*:<>?\/\\|\x00-\x1f\x7f-\x9f]/g,t}(U),nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getById=function(e){return new rn(this,"GetById?hubSiteId='"+e+"'")},t=o([d("_api/hubsites")],t)}(j),rn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(k),on=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=""),this._options=e,this._baseUrl=t}return e.prototype.configure=function(t,n){return void 0===n&&(n=""),new e(t,n)},e.prototype.setup=function(e){p(e)},e.prototype.searchSuggest=function(e){var t;return t="string"==typeof e?{querytext:e}:e,this.create(Ht).execute(t)},e.prototype.search=function(e){return this.create(Ft).execute(e)},e.prototype.searchWithCaching=function(e,t){return this.create(Ft).usingCaching(t).execute(e)},Object.defineProperty(e.prototype,"site",{get:function(){return this.create(gt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"web",{get:function(){return this.create(Et)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profiles",{get:function(){return this.create(Kt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"social",{get:function(){return this.create(Qt)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigation",{get:function(){return this.create(_t)},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return this.web.createBatch()},Object.defineProperty(e.prototype,"utility",{get:function(){return this.create(tn,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteScripts",{get:function(){return this.create(Zt,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteDesigns",{get:function(){return this.create(en,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hubSites",{get:function(){return this.create(nn)},enumerable:!0,configurable:!0}),e.prototype.getTenantAppCatalogWeb=function(){var e=this;return this.create(Et,"_api/SP_TenantSettings_Current").get().then(function(t){return new Et(t.CorporateCatalogUrl).configure(e._options)})},e.prototype.create=function(e,t){return new e(this._baseUrl,t).configure(this._options)},e}(),sn=new on}).call(t,n(0))},function(e,t,n){"use strict";n(17).polyfill()},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){var r=n(12),o=n(13);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)o.loadStyles(r[i][1]);r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(16)(),t.push([e.i,'.helloWorld_e50749f6 .container_e50749f6{max-width:700px;margin:0 auto;box-shadow:0 2px 4px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.1)}.helloWorld_e50749f6 .row_e50749f6{margin:0 -8px;box-sizing:border-box;color:"[theme:white, default: #ffffff]";background-color:"[theme:themeDark, default: #005a9e]";padding:20px}.helloWorld_e50749f6 .row_e50749f6:after,.helloWorld_e50749f6 .row_e50749f6:before{display:table;content:"";line-height:0}.helloWorld_e50749f6 .row_e50749f6:after{clear:both}.helloWorld_e50749f6 .column_e50749f6{position:relative;min-height:1px;padding-left:8px;padding-right:8px;box-sizing:border-box}[dir=ltr] .helloWorld_e50749f6 .column_e50749f6{float:left}[dir=rtl] .helloWorld_e50749f6 .column_e50749f6{float:right}.helloWorld_e50749f6 .column_e50749f6 .ms-Grid_e50749f6{padding:0}@media (min-width:640px){.helloWorld_e50749f6 .column_e50749f6{width:83.33333333333334%}}@media (min-width:1024px){.helloWorld_e50749f6 .column_e50749f6{width:66.66666666666666%}}@media (min-width:1024px){[dir=ltr] .helloWorld_e50749f6 .column_e50749f6{left:16.66667%}[dir=rtl] .helloWorld_e50749f6 .column_e50749f6{right:16.66667%}}@media (min-width:640px){[dir=ltr] .helloWorld_e50749f6 .column_e50749f6{left:8.33333%}[dir=rtl] .helloWorld_e50749f6 .column_e50749f6{right:8.33333%}}.helloWorld_e50749f6 .title_e50749f6{font-size:21px;font-weight:100;color:"[theme:white, default: #ffffff]"}.helloWorld_e50749f6 .description_e50749f6,.helloWorld_e50749f6 .subTitle_e50749f6{font-size:17px;font-weight:300;color:"[theme:white, default: #ffffff]"}.helloWorld_e50749f6 .button_e50749f6{text-decoration:none;height:32px;min-width:80px;background-color:"[theme:themePrimary, default: #0078d7]";border-color:"[theme:themePrimary, default: #0078d7]";color:"[theme:white, default: #ffffff]";outline:transparent;position:relative;font-family:Segoe UI WestEuropean,Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;border-width:0;text-align:center;cursor:pointer;display:inline-block;padding:0 16px}.helloWorld_e50749f6 .button_e50749f6 .label_e50749f6{font-weight:600;font-size:14px;height:32px;line-height:32px;margin:0 4px;vertical-align:top;display:inline-block}',""])},function(e,t,n){"use strict";(function(e){function n(e){var t=Array.isArray(e)?e:l(e);void 0===d&&(d=h()),o(t)}function r(e){g.loadStyles=e}function o(e,t){g.loadStyles?g.loadStyles(c(e),e):d?f(e,t):p(e,t)}function i(e){g.theme=e,a()}function s(){g.registeredStyles.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)}),g.registeredStyles=[]}function a(){if(g.theme)for(var e=0,t=g.registeredStyles;e<t.length;e++){var n=t[e];o(n.themableStyle,n)}}function u(e){return e&&(e=c(l(e))),e}function c(e){var t=g.theme;return(e||[]).map(function(e){var n=e.theme;if(n){var r=t?t[n]:void 0,o=e.defaultValue||"inherit";return t&&!r&&console,r||o}return e.rawString}).join("")}function l(e){var t=[];if(e){for(var n=0,r=void 0;r=m.exec(e);){var o=r.index;o>n&&t.push({rawString:e.substring(n,o)}),t.push({theme:r[1],defaultValue:r[2]}),n=m.lastIndex}t.push({rawString:e.substring(n)})}return t}function p(e,t){var n=document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.appendChild(document.createTextNode(c(e))),t?(n.replaceChild(r,t.styleElement),t.styleElement=r):n.appendChild(r),t||g.registeredStyles.push({styleElement:r,themableStyle:e})}function f(e,t){var n=document.getElementsByTagName("head")[0],r=g.registeredStyles,o=g.lastStyleElement,i=o?o.styleSheet:void 0,s=i?i.cssText:"",a=r[r.length-1],l=c(e);(!o||s.length+l.length>v)&&(o=document.createElement("style"),o.type="text/css",t?(n.replaceChild(o,t.styleElement),t.styleElement=o):n.appendChild(o),t||(a={styleElement:o,themableStyle:e},r.push(a))),o.styleSheet.cssText+=u(l),Array.prototype.push.apply(a.themableStyle,e),g.lastStyleElement=o}function h(){var e=!1;if("undefined"!=typeof document){var t=document.createElement("style");t.type="text/css",e=!!t.styleSheet}return e}Object.defineProperty(t,"__esModule",{value:!0});var d,y="undefined"==typeof window?e:window,g=y.__themeState__=y.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]},m=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,v=1e4;t.loadStyles=n,t.configureLoadStyles=r,t.loadTheme=i,t.clearStyles=s,t.detokenize=u,t.splitStyles=l}).call(t,n(0))},function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function i(e){return f.a.log({data:0===f.a.activeLogLevel?e.result:{},level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(e.result)}function s(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function a(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function u(e){e.pipeline.length<1&&f.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2);var t=a(e).then(function(e){return i(e)}).catch(function(e){throw f.a.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function c(e){return void 0===e&&(e=!1),function(t,r,o){var i=o.value;o.value=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return!e&&o.length>0&&n.i(p.b)(o[0],"hasResult")&&o[0].hasResult?(f.a.write("["+o[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+r+", existing result in pipeline.",0),Promise.resolve(o[0])):(f.a.write("["+o[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+r+".",0),i.apply(t,o).then(function(e){return a(e)}))}}}function l(){return[w.logStart,w.caching,w.send,w.logEnd].slice(0)}var p=n(1),f=n(2);n.d(t,"i",function(){return h}),n.d(t,"a",function(){return m}),n.d(t,"b",function(){return v}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return _}),n.d(t,"g",function(){return S}),n.d(t,"f",function(){return T}),n.d(t,"c",function(){return C}),n.d(t,"h",function(){return O});/**
 * @license
 * v1.3.3
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
var h=function(){function e(e){this.key=e,this.expiration=n.i(p.m)(new Date,"second",p.e.defaultCachingTimeoutSeconds),this.storeName=p.e.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new p.q,e}(),d=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}(),y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},g=function(e){function t(t,n,r,o){void 0===r&&(r=n.status),void 0===o&&(o=n.statusText);var i=e.call(this,t)||this;return i.response=n,i.status=r,i.statusText=o,i.isHttpRequestError=!0,i}return r(t,e),t.init=function(e){return e.clone().text().then(function(n){return new t("Error making HttpClient request in queryable ["+e.status+"] "+e.statusText+" ::> "+n,e.clone())})},t}(Error),m=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&t.parseImpl(e,n,r)})},e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||g.init(e).then(t),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return n.i(p.b)(e,"d")?t=n.i(p.b)(e.d,"results")?e.d.results:e.d:n.i(p.b)(e,"value")&&(t=e.value),t},e}(),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(m),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)},t}(m),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(m),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(m),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parseImpl=function(e,t){n.i(p.r)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(m),w=(function(e){function t(t){var n=e.call(this)||this;return n.parser=t,n}r(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)}}(m),function(){function e(){}return e.logStart=function(e){return new Promise(function(t){f.a.log({data:1===f.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if(e.isCached){f.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var r=new h(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(r=n.i(p.d)(r,e.cachingOptions)),null!==r.store){var o=r.store.get(r.key);if(null!==o)return f.a.log({data:1===f.a.activeLogLevel?{}:o,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),n.i(p.r)(e.batchDependency)&&e.batchDependency(),n.i(p.b)(e.parser,"hydrate")&&(o=e.parser.hydrate(o)),s(e,o).then(function(e){return t(e)})}f.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),e.parser=new d(e.parser,r)}return t(e)})},e.send=function(e){return new Promise(function(t,r){if(e.isBatched){var o=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);n.i(p.r)(e.batchDependency)&&e.batchDependency(),f.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",1),t(s(e,o))}else{f.a.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var i=e.clientFactory(),a=n.i(p.d)(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,a).then(function(t){return e.parser.parse(t)}).then(function(t){return s(e,t)}).then(function(e){return t(e)}).catch(function(e){return r(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?f.a.log({data:1===f.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):f.a.log({data:1===f.a.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},o([c(!0)],e,"logStart",null),o([c()],e,"caching",null),o([c()],e,"send",null),o([c(!0)],e,"logEnd",null),e}()),P=function(){function e(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null,this._cloneParentWasCaching=!1,this._cloneParentCacheOptions=null,this._requestPipeline=null}return e.prototype.toUrl=function(){return this._url},e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return n.i(p.j)(this._options,e),this},e.prototype.configureFrom=function(e){return n.i(p.j)(this._options,e._options),this},e.prototype.usingCaching=function(e){return p.e.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.withPipeline=function(e){return this._requestPipeline=e.slice(0),this},e.prototype.getCore=function(e,t){return void 0===e&&(e=new S),void 0===t&&(t={}),this._cloneParentWasCaching&&this.usingCaching(this._cloneParentCacheOptions),this.reqImpl("GET",t,e)},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new S),this.reqImpl("POST",e,t)},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new S),this.reqImpl("PATCH",e,t)},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new S),this.reqImpl("DELETE",e,t)},e.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new S),this.reqImpl("PUT",e,t)},e.prototype.reqImpl=function(e,t,n){var r=this;return void 0===t&&(t={}),this.getRequestPipeline(e,t,n).then(function(o){return r.toRequestContext(e,t,n,o)}).then(function(e){return u(e)})},e.prototype.append=function(e){this._url=n.i(p.c)(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this._parentUrl=e._url,this._url=n.i(p.c)(this._parentUrl,t||""),this.configureFrom(e)},e.prototype._clone=function(e,t){return e.configureFrom(this),this._useCaching&&(e._cloneParentWasCaching=!0,e._cloneParentCacheOptions=this._cachingOptions),e},e.prototype.getRequestPipeline=function(e,t,r){var o=this;return void 0===t&&(t={}),new Promise(function(e){e(n.i(p.n)(o._requestPipeline)&&n.i(p.p)(o._requestPipeline)?o._requestPipeline:l())})},e}(),C=function(e){function t(){var t=e.call(this)||this;return t._batch=null,t._batchDependency=null,t}return r(t,e),t.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return n.i(p.n)(e)&&(this._batch=e),this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(e,t){return void 0===e&&(e=new v),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(t,n){return void 0===t&&(t=new v),void 0===n&&(n={}),e.prototype.getCore.call(this,t,n)},t.prototype.postCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new v),e.prototype.postCore.call(this,t,n)},t.prototype.patchCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new v),e.prototype.patchCore.call(this,t,n)},t.prototype.deleteCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new v),e.prototype.deleteCore.call(this,t,n)},t.prototype.putCore=function(t,n){return void 0===t&&(t={}),void 0===n&&(n=new v),e.prototype.putCore.call(this,t,n)},t.prototype.reqImpl=function(t,n,r){return void 0===n&&(n={}),this.hasBatch&&(this._batchDependency=this.addBatchDependency()),e.prototype.reqImpl.call(this,t,n,r)},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return n.i(p.n)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t.prototype._clone=function(t,n){return t=e.prototype._clone.call(this,t,n),n.includeBatch&&(t=t.inBatch(this._batch)),t},t}(P),O=function(){function e(e){void 0===e&&(e=n.i(p.k)()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r,o){var i={id:o,method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},s=new Promise(function(e,t){i.resolve=e,i.reject=t});return this._reqs.push(i),s},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise(function(t){e=t})),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return Promise.all(e._deps)}).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},e}()},function(e,t){/*! adal-angular v1.0.17 2018-02-27 */
var n=function(){"use strict";return n=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},n.prototype._singletonInstance)return n.prototype._singletonInstance;if(n.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),n.prototype.login=function(){if(this._loginInProgress)return void this.info("Login in progress");this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)},n.prototype._openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-n/2+o,c=a/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+c+", left="+u);return l.focus&&l.focus(),l}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},n.prototype._handlePopupError=function(e,t,n,r,o){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},n.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null==r){var i="Popup Window is null. This can happen if you are using IE";return void this._handlePopupError(o,t,"Error opening popup",i,i)}if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var s=this.config.redirectUri.split("#")[0];else var s=this.config.redirectUri;var a=this,u=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return a.isAngular&&a._broadcast("adal:popUpClosed",n+a.CONSTANTS.RESOURCE_DELIMETER+e),a._handlePopupError(o,t,e,n,n),void window.clearInterval(u)}try{var i=r.location;if(-1!=encodeURI(i.href).indexOf(encodeURI(s)))return a.isAngular?a._broadcast("adal:popUpHashChanged",i.hash):a.handleWindowCallback(i.hash),window.clearInterval(u),a._loginInProgress=!1,a._acquireTokenInProgress=!1,a.info("Closing popup window"),a._openedWindows=[],void r.close()}catch(e){}},1)},n.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},n.prototype.loginInProgress=function(){return this._loginInProgress},n.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},n.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},n.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},n.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,o,i,s){r._activeRenewals[t]=null;for(var a=0;a<r._callBacksMappedToRenewStates[e].length;++a)try{r._callBacksMappedToRenewStates[e][a](n,o,i,s)}catch(i){r.warn(i)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},n.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),n=n||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(o,e,t),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+e,e)},n.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var o=null===t||void 0===t?null:this.config.clientId,t=t||"id_token",i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,o),"prompt");i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},n.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},n.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},n.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},n.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},n.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},n.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(o,e,r),this._loginPopup(i,e,r)},n.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+e;this.config.state=o,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},n.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},n.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},n.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},n.prototype.logOut=function(){this.clearCache(),this._user=null;var e;if(this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},n.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},n.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)return void e(null,this._user);var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))},n.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},n.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},n.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},n.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},n.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},n.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r="";if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},n.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},n.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},n.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},n.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]);var n;e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},n.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},n.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},n.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,o,i=t.getRequestInfo(e),s=null;o=n||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ID_TOKEN);var a=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=i.parameters[t.CONSTANTS.ERROR];try{o&&o(a,r,u,s)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},n.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},n.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},n.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},n.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=String(e).replace(/=+$/,"");var n=e.length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,s,a,u,c,l,p="",f=0;f<n;f+=4){if(r=t.indexOf(e.charAt(f)),o=t.indexOf(e.charAt(f+1)),i=t.indexOf(e.charAt(f+2)),s=t.indexOf(e.charAt(f+3)),f+2===n-1){a=r<<18|o<<12|i<<6,u=a>>16&255,c=a>>8&255,p+=String.fromCharCode(u,c);break}if(f+1===n-1){a=r<<18|o<<12,u=a>>16&255,p+=String.fromCharCode(u);break}a=r<<18|o<<12|i<<6|s,u=a>>16&255,c=a>>8&255,l=255&a,p+=String.fromCharCode(u,c,l)}return p},n.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/,n=t.exec(e);return!n||n.length<4?(this.warn("The returned id_token is not parseable."),null):{header:n[1],JWSPayload:n[2],JWSSig:n[3]}},n.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},n.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var o=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(o))}return r.join("&")},n.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},n.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(o=16*Math.random()|0),"x"===n[s]?i+=r[o]:"y"===n[s]?(o&=3,o|=8,i+=r[o]):i+=n[s];return i},n.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},n.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},n.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},n.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},n.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},n.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},n.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var o=(new Date).toUTCString(),i="";i=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(i+="\nstack:\n"+n.stack),Logging.log(i)}},n.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},n.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},n.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},n.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},n.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},n.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},n.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},n.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},n.prototype._libVersion=function(){return"1.0.17"},void 0!==e&&e.exports&&(e.exports=n,e.exports.inject=function(e){return new n(e)}),n}()},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(e,t,n){"use strict";function r(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(void 0!==o&&null!==o)for(var i=Object.keys(Object(o)),s=0,a=i.length;s<a;s++){var u=i[s],c=Object.getOwnPropertyDescriptor(o,u);void 0!==c&&c.enumerable&&(n[u]=o[u])}}return n}function o(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}e.exports={assign:r,polyfill:o}},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(s=2&n[0]?i.return:n[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){u.label=n[1];break}if(6===n[0]&&u.label<s[1]){u.label=s[1],s=n;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(n);break}s[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(t,"__esModule",{value:!0});var s=n(7),a=n(9),u=n(8),c=n(5);n(4),n(6);var l=n(3),p=n(10),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){return o(this,void 0,void 0,function(){var e;return i(this,function(t){switch(t.label){case 0:return this.domElement.innerHTML='\n      <div class="'+l.default.helloWorld+'">\n        <div class="'+l.default.container+'">\n          <div class="'+l.default.row+'">\n            <div class="'+l.default.column+'">\n              <span class="'+l.default.title+'">Welcome to SharePoint!</span>\n              <p class="'+l.default.subTitle+'">Customize SharePoint experiences using Web Parts.</p>\n              <p class="'+l.default.description+'">'+u.escape(this.properties.description)+'</p>\n              <a href="https://aka.ms/spfx" class="'+l.default.button+'">\n                <span class="'+l.default.label+'">Learn more</span>\n              </a>\n            </div>\n            <div>\n                  <input id="Title" placeholder="Title" />          \n                  <input id="Nome" placeholder="Nome" />\n                  <input id="Cognome" placeholder="Cognome" />\n                  <button id="AddSPItem" type="submit">Aggiungi Elemento</button>\n                  <button id="UpdateSPItem" type="submit">Aggiorna Elemento</button>\n                  <button id="DeleteSPItem" type="submit">Cancella Elemento</button>\n            </div>\n            <br>\n            <div id ="DivGetItems" />\n          </div>\n        </div>\n       </div>\n      ',this.AddEventListeners(),console.log("Inizio chiamata getSPItems"),this.getSPItems(),e=SP.UI.ModalDialog.showWaitScreenWithNoClose("Processing...","questa modal scomparirà tra qualche secondo...",130,350),console.log("Inizio render --\x3e main()"),[4,this.main()];case 1:return t.sent(),console.log("Fine render --\x3e main()"),e.close(SP.UI.DialogResult.OK),[2]}})})},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return s.Version.parse("1.0")},enumerable:!0,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:p.PropertyPaneDescription},groups:[{groupName:p.BasicGroupName,groupFields:[a.PropertyPaneTextField("description",{label:p.DescriptionFieldLabel})]}]}]}},t.prototype.AddEventListeners=function(){var e=this;document.getElementById("AddSPItem").addEventListener("click",function(){return e.AddSPItem()}),document.getElementById("DeleteSPItem").addEventListener("click",function(){return e.deleteSPItems()}),document.getElementById("UpdateSPItem").addEventListener("click",function(){return e.UpdateSPItems()})},t.prototype.AddSPItem=function(){c.sp.web.lists.getByTitle("prova").items.add({Nome:document.getElementById("Nome").value,Cognome:document.getElementById("Cognome").value,Title:document.getElementById("Title").value}).then(function(e){alert("Operazone Completata"),console.log(e.item)}).catch(function(e){return console.log(e)})},t.prototype.getSPItems=function(){var e=this;c.sp.web.lists.getByTitle("prova").items.getAll().then(function(t){var n="<div>";t.length>0?t.forEach(function(e){n+=e.ID+" "+e.Cognome+"</br>",console.log(e.ID+" "+e.Cognome)}):n+="Non ci sono elementi</br>",n+="</div>",e.domElement.querySelector("#DivGetItems").innerHTML=n}).catch(function(e){return console.log(e)})},t.prototype.getSPItemsAsync=function(){return o(this,void 0,void 0,function(){var e,t,n;return i(this,function(r){switch(r.label){case 0:return[4,c.sp.web.lists.getByTitle("prova").items.getAll()];case 1:return e=r.sent(),t="<div>",e.length>0?e.forEach(function(e){t+=e.ID+" "+e.Cognome+"</br>",console.log(e.ID+" "+e.Cognome)}):t+="Non ci sono elementi</br>",t+="</div>",n=this.domElement.querySelector("#DivGetItems"),n.innerHTML=t,[2]}})})},t.prototype.deleteSPItems=function(){c.sp.web.lists.getByTitle("prova").items.getById(1).delete().then(function(e){})},t.prototype.UpdateSPItems=function(){c.sp.web.lists.getByTitle("prova").items.getById(1).update({Nome:document.getElementById("Nome").value,Cognome:document.getElementById("Cognome").value,Title:document.getElementById("Title").value}).then(function(e){console.log(e)})},t.prototype.main=function(){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return console.log("Inizio main()"),[4,Promise.all([this.logConsole("1",1e4),this.logConsole("2",10)])];case 1:return e.sent(),console.log("Fine main()"),[2]}})})},t.prototype.logConsole=function(e,t){return o(this,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:return console.log("Inizio LogConsole"),[4,Promise.resolve(setTimeout(function(){console.log(e)},t))];case 1:return n.sent(),console.log("Fine LogConsole"),[2]}})})},t}(a.BaseClientSideWebPart);t.default=f}])});